<!DOCTYPE html> <html xmlns="http://www.w3.org/1999/xhtml" lang="en-US" xml:lang="en-US" itemscope="" itemtype="http://schema.org/WebSite"> <head> <meta charset="utf-8"/> <meta name="description" content="Always submit changes to the code in a separate pull request from the changes to its unit tests, in another pull request." /> <meta name="keywords" content="" /> <meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1"/> <meta name="google-site-verification" content="JEj_gQr2CPe2QKGw8XdMz0R7VboQIUbX3FlM-lwTq-8" /> <meta name="author" content="Yegor Bugayenko"> <meta name="og:site_name" content="Yegor Bugayenko"/> <meta name="og:type" content="article" /> <meta name="og:locale" content="en_US" /> <meta name="twitter:account_id" content="4503599630178231" /> <meta name="twitter:creator" content="@yegor256"/> <meta name="twitter:site" content="@yegor256"/> <meta name="twitter:title" property="og:title" content="The Code and Its Tests in Different Pull Requests"/> <meta name="twitter:description" property="og:description" content="Always submit changes to the code in a separate pull request from the changes to its unit tests, in another pull request."/> <meta name="twitter:url" property="og:url" content="https://www.yegor256.com/russian/2022/08/04/code-and-tests-different-pull-requests.html"/> <meta name="telegram:channel" content="AAAAAEJFMRzsRTRxM3ec6A"/> <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="yegor256" /> <link rel="shortcut icon" href="/favicon.ico?b4eea1aa36b"/> <link rel="apple-touch-icon" href="/favicon.ico?b4eea1aa36b"/> <link rel="alternate" type="application/rss+xml" title="RSS for yegor256.com" href="https://www.yegor256.com/rss.xml"/> <link rel="stylesheet" href="/css/layout.css?b4eea1aa36b"/> <link rel="stylesheet" href="/css/icons.css?b4eea1aa36b"/> <link rel="canonical" href="https://www.yegor256.com/russian/2022/08/04/code-and-tests-different-pull-requests.html" /> <title>The Code and Its Tests in Different Pull Requests</title> </head> <body><div class="wrapper"> <aside class="header-toggle unprintable" id="header-toggle" title="Show the menu" onclick="$('#header').show();$('#header-toggle').hide();">&#9776;</aside> <header class="header" id="header"><div class="face"> <a href="/about-me.html#form" class="sub" title="Click to subscribe to my monthly newsletter"><span>Subscribe</span></a> <a href="/about-me.html" style="position:relative;"> <img src="/images/face-256x256.jpg" class="photo" alt="Yegor Bugayenko"/> </a></div><nav><ul class="menu social notranslate"> <li><a href="https://twitter.com/intent/follow?screen_name=yegor256" rel="nofollow" title="Follow me on Twitter"><i class="icon icon-twitter notranslate" aria-hidden="true"></i></a></li> <li><a href="/rss.xml" rel="nofollow" title="Subscribe to my RSS feed"><i class="icon icon-rss notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://github.com/yegor256" rel="nofollow" title="My GitHub profile"><i class="icon icon-github notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="http://stackoverflow.com/users/187141/yegor256" rel="nofollow" title="My Stack Overflow profile"><i class="icon icon-stackoverflow notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.facebook.com/yegor256" rel="nofollow" title="Follow me on Facebook"><i class="icon icon-facebook notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://instagram.com/yegor256" rel="nofollow" title="Follow me on Instagram"><i class="icon icon-instagram notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.linkedin.com/in/yegor256" rel="nofollow" title="My LinkedIn profile"><i class="icon icon-linkedin notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.youtube.com/c/yegor256?sub_confirmation=1" rel="nofollow" title="My Youtube video channel"><i class="icon icon-youtube notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.pinterest.com/yegor256/" rel="nofollow" title="My Pinterest boards"><i class="icon icon-pinterest notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://angel.co/yegor256" rel="nofollow" title="My AngelList profile"><i class="icon icon-angellist notranslate" aria-hidden="true"></i></a></li> <li><a href="https://soundcloud.com/yegor256" rel="nofollow" title="My podcast"><i class="icon icon-podcast notranslate" aria-hidden="true"></i></a></li> <li><a href="https://itunes.apple.com/us/podcast/yegor256-podcast/id1150826721" rel="nofollow" title="My iTunes podcast"><i class="icon icon-itunes notranslate" aria-hidden="true"></i></a></li> <li><a href="https://t.me/yegor256news" rel="nofollow" title="My Telegram public channel"><i class="icon icon-telegram notranslate" aria-hidden="true"></i></a></li> <li><a href="mailto:blog@yegor256.com" rel="nofollow" title="Email me any time"><i class="icon icon-mail notranslate" aria-hidden="true"></i></a></li></ul><ul class="menu"> <li><a href="/" title="Home page">Home</a></li> <li ><a href="/best.html" title="Best articles to read">12&#160;Best</a></li> <li ><a href="/contents.html" title="The contents of the entire blog">All&#160;385</a></li> <li ><a href="/teaching.html" title="My courses and lectures">Teaching</a></li> <li ><a href="/talks.html" title="Future and past conference talks">Talks</a></li> <li ><a href="/books.html" title="The books I wrote">Books</a></li> <li ><a href="/papers.html" title="My academic papers and patents">Papers</a></li> <li ><a href="/pets.html" title="My loved pet projects">Pets</a></li> <li ><a href="/award.html" title="Software quality award">Award</a></li> <li ><a href="/testimonials.html" title="What some people say about me">Testimonials</a></li> <li ><a href="/shift-m.html" title="Audio podcast about project management">Shift-M</a></li> <li ><a href="/paintings.html" title="My paintings for sale">Art</a></li> <li><a href="https://ru.yegor256.com/" title="Немного на русском языке о политике в России, Украине и мире">Политика</a></li></ul></nav><div class="search"> <form method="get" action="https://www.google.com/search" itemprop="potentialAction" itemscope="" itemtype="http://schema.org/SearchAction"> <meta itemprop="target" content="https://www.google.com/search?q={q}"/> <input name="sitesearch" value="yegor256.com" type="hidden"/> <input itemprop="query-input" type="text" id="search-query" class="field field-text" required="required" onfocus="$('.google').css('visibility', 'visible');" name="q" placeholder="Search..." autocomplete="off"/> <input type="image" src="/images/google-search-icon.svg" class="google" title="Search via Google" alt="Search via Google"/> </form></div><div class="hot"><ul></ul></div></header></div><section itemscope="" itemtype="http://schema.org/BlogPosting"><div class="wrapper"> <header><h1 itemprop="name headline mainEntityOfPage">The Code and Its Tests in Different Pull Requests</h1></header> <article class="main" itemprop="articleBody" style="font-family: sans-serif; font-size: 0.9em; line-height: 1.2em;"><p style="color: #C42C00;">The following text is a translation of the <a href='https://www.yegor256.com/2022/08/04/code-and-tests-different-pull-requests.html'>original English article</a>, performed by <a href="https://chat.openai.com/">ChatGPT</a> (gpt-3.5-turbo) and <a href="https://github.com/yegor256/jekyll-chatgpt-translate">this Jekyll plugin</a>:</p><p>Я предложил эту идею несколько недель назад <a href="https://twitter.com/yegor256/status/1525758255225528320">на Twitter</a> и получил в основном отрицательные реакции. Вот почему я написал этот блог-пост, чтобы более подробно рассказать об этой теме и попытаться вас убедить. Вот правило, которое я предлагаю: всегда вносите изменения в код и отдельно изменения в его модульные тесты. Просто говоря, в одном pull request вы изменяете тесты, возможно, отмечая некоторые из них как “отключенные”. Вы сливаете этот pull request, а затем создаете второй, изменяя код и, скорее всего, удаляя “отключенные” маркеры из тестов. Вы не трогаете содержимое тестов во втором pull request.</p><p>Это может показаться противоречием принципам <a href="">TDD</a>. Однако для меня такой подход выглядит как крайнее применение TDD, а не нарушение его. Сначала мы объединяем тесты, что, скорее всего, нарушит сборку, так как функциональность, которую они проверяют, еще не реализована. Чтобы избежать нарушения состояния сборки, мы отключаем новые тесты, которые добавили, и тесты, которые мы изменили. В <a href="https://junit.org/junit5/docs/current/user-guide/">JUnit 5</a> мы делаем это, например, с помощью аннотации <a href="https://junit.org/junit5/docs/5.0.0-M2/api/org/junit/jupiter/api/Disabled.html"><code class="language-plaintext highlighter-rouge">@Disabled</code></a>.</p><p>Рецензенты подтверждают изменения, которые вы вносите, задавая себе следующие вопросы: “Нужна ли нам действительно эта новая функциональность? Конфликтует ли она с уже существующей функциональностью? Есть ли смысл проверять новую функциональность именно таким образом?” Они не задумываются о <em>том, как</em> функциональность будет реализована, им важны только <em>требования</em>, которые вы накладываете в своих тестах на продукт. В этой стадии рецензенты выступают, скорее, в роли инженеров по требованиям. Они проверяют <em>намерение</em>, а не <em>реализацию</em>.</p><p>Затем, во втором запросе на объединение изменений, вы изменяете код, не затрагивая тесты. Теперь рецензенты могут быть уверены, что вы не изменили требования только для того, чтобы они лучше соответствовали вашей реализации. Иными словами, они знают, что вы не <em>жульничали</em>. Поскольку вы не трогали тесты, это гарантирует рецензентам, что требования остаются неизменными, а вы изменяете только реализацию. Говоря деловым языком, вы не меняете <em>контракт</em>, когда вы понимаете, что не можете выполнить то, что было <em>обещано</em>.</p><p>Более того, когда вы изменяете только тесты, не затрагивая код, рецензентам гораздо проще понять, действительно ли ваши изменения относятся к решению проблемы, которую вам предстоит решить. Мы программисты часто делаем типичную ошибку: мы изменяем код, некоторые тесты не проходят, мы исправляем тесты… неважно, они “наши” тесты или нет. Мы просто заставляем тесты проходить, независимо от <em>причин</em> их неудачи. Вместо того, чтобы <em>слушать</em> их, мы их заглушаем. Позже рецензенты могут не понимать, почему были изменены некоторые тесты. Особенно если запрос на внесение изменений большой. Они, скорее всего, просто доверятся вам и сольют ваш запрос на внесение изменений.</p><p>Вот почему отделение тестов от кода является решением. Сначала тесты изменяются, и рецензенты обращают внимание только на область тестирования. Они легко заметят, если изменения слишком широкие и не связаны с решаемой проблемой. Затем код изменяется, и рецензентам не нужно беспокоиться о тестах вообще. Они на них не обращают внимание, а только рецензируют реализацию. Они знают, что нельзя сломать тесты, так как конвейер сборки не позволит вам это сделать.</p><p>What do you think now? Does it make sense?</p><p class="jekyll-chatgpt-translate">Translated by ChatGPT gpt-3.5-turbo/0.0.20 on 2023-08-23 at 07:19</p></article></div><div class="wrapper"> <footer class="footer"><p> &copy; <span itemscope="" itemprop="copyrightHolder" itemtype="http://schema.org/Person"> <span itemprop="name">Yegor Bugayenko</span> </span> 2014&ndash;<span itemprop="copyrightYear">2023</span></p></footer></div></section><div class="wrapper unprintable" style="text-align:center;margin-top:2em;"> <a href="https://www.sixnines.io/h/3ba1652f"> <img src="//www.sixnines.io/b/3ba1652f?style=flat" alt="sixnines availability badge" /></a> &nbsp; <a href="https://github.com/yegor256/blog/stargazers"> <img src="//img.shields.io/github/stars/yegor256/blog.svg?style=flat-square" alt="GitHub stars" /></a></div><script src="//code.jquery.com/jquery-1.9.0.min.js"></script> <script src="/js/all.js?b4eea1aa36b"></script> <script>var disqus_shortname = 'yegor256';</script> <script id="dsq-count-scr" src="//yegor256.disqus.com/count.js" async="async"></script> <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','//www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-1963507-32', 'auto'); ga('send', 'pageview'); </script> <script> Cd=document;Cr="&"+Math.random();Cp="&s=1"; Cd.cookie="b=b";if(Cd.cookie)Cp+="&c=1"; Cp+="&t="+(new Date()).getTimezoneOffset(); if(self!=top)Cp+="&f=1"; </script> <script> if(navigator.javaEnabled())Cp+="&j=1"; </script> <script> if(typeof(screen)!='undefined')Cp+="&w="+screen.width+"&h="+ screen.height+"&d="+(screen.colorDepth?screen.colorDepth:screen.pixelDepth); </script> <script> Cd.write("<img src='//c.hit.ua/hit?i=95870&g=0&x=2"+Cp+Cr+ "&r="+escape(Cd.referrer)+"&u="+escape(window.location.href)+ "' border='0' wi"+"dth='1' he"+"ight='1'/>"); </script> <script type="application/ld+json"> { "@context": "http://schema.org", "@type": "Person", "name": "Yegor Bugayenko", "url": "https://www.yegor256.com", "sameAs": [ "https://www.facebook.com/yegor256", "https://instagram.com/yegor256", "https://www.linkedin.com/in/yegor256", "https://twitter.com/yegor256", "https://github.com/yegor256", "https://www.pinterest.com/yegor256/" ] } </script> </body> </html>
