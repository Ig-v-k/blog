<!DOCTYPE html> <html xmlns="http://www.w3.org/1999/xhtml" lang="en-US" xml:lang="en-US" itemscope="" itemtype="http://schema.org/WebSite"> <head> <meta charset="utf-8"/> <meta name="description" content="Many of us have our own custom release/deployment scripts which work just fine. What value can Rultor add to them?" /> <meta name="keywords" content="" /> <meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1"/> <meta name="google-site-verification" content="JEj_gQr2CPe2QKGw8XdMz0R7VboQIUbX3FlM-lwTq-8" /> <meta name="author" content="Yegor Bugayenko"> <meta name="og:site_name" content="Yegor Bugayenko"/> <meta name="og:type" content="article" /> <meta name="og:locale" content="en_US" /> <meta name="twitter:account_id" content="4503599630178231" /> <meta name="twitter:creator" content="@yegor256"/> <meta name="twitter:site" content="@yegor256"/> <meta name="twitter:title" property="og:title" content="Deployment Script vs. Rultor"/> <meta name="twitter:description" property="og:description" content="Many of us have our own custom release/deployment scripts which work just fine. What value can Rultor add to them?"/> <meta name="twitter:url" property="og:url" content="https://www.yegor256.com/chinese/2014/09/11/deployment-script-vs-rultor.html"/> <meta name="telegram:channel" content="AAAAAEJFMRzsRTRxM3ec6A"/> <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="yegor256" /> <link rel="shortcut icon" href="/favicon.ico?3a3b5d6c83f"/> <link rel="apple-touch-icon" href="/favicon.ico?3a3b5d6c83f"/> <link rel="alternate" type="application/rss+xml" title="RSS for yegor256.com" href="https://www.yegor256.com/rss.xml"/> <link rel="stylesheet" href="/css/layout.css?3a3b5d6c83f"/> <link rel="stylesheet" href="/css/icons.css?3a3b5d6c83f"/> <link rel="canonical" href="https://www.yegor256.com/chinese/2014/09/11/deployment-script-vs-rultor.html" /> <title>Deployment Script vs. Rultor</title> </head> <body><div class="wrapper"> <aside class="header-toggle unprintable" id="header-toggle" title="Show the menu" onclick="$('#header').show();$('#header-toggle').hide();">&#9776;</aside> <header class="header" id="header"><div class="face"> <a href="/about-me.html#form" class="sub" title="Click to subscribe to my monthly newsletter"><span>Subscribe</span></a> <a href="/about-me.html" style="position:relative;"> <img src="/images/face-256x256.jpg" class="photo" alt="Yegor Bugayenko"/> </a></div><nav><ul class="menu social notranslate"> <li><a href="https://twitter.com/intent/follow?screen_name=yegor256" rel="nofollow" title="Follow me on Twitter"><i class="icon icon-twitter notranslate" aria-hidden="true"></i></a></li> <li><a href="/rss.xml" rel="nofollow" title="Subscribe to my RSS feed"><i class="icon icon-rss notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://github.com/yegor256" rel="nofollow" title="My GitHub profile"><i class="icon icon-github notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="http://stackoverflow.com/users/187141/yegor256" rel="nofollow" title="My Stack Overflow profile"><i class="icon icon-stackoverflow notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.facebook.com/yegor256" rel="nofollow" title="Follow me on Facebook"><i class="icon icon-facebook notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://instagram.com/yegor256" rel="nofollow" title="Follow me on Instagram"><i class="icon icon-instagram notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.linkedin.com/in/yegor256" rel="nofollow" title="My LinkedIn profile"><i class="icon icon-linkedin notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.youtube.com/c/yegor256?sub_confirmation=1" rel="nofollow" title="My Youtube video channel"><i class="icon icon-youtube notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.pinterest.com/yegor256/" rel="nofollow" title="My Pinterest boards"><i class="icon icon-pinterest notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://angel.co/yegor256" rel="nofollow" title="My AngelList profile"><i class="icon icon-angellist notranslate" aria-hidden="true"></i></a></li> <li><a href="https://soundcloud.com/yegor256" rel="nofollow" title="My podcast"><i class="icon icon-podcast notranslate" aria-hidden="true"></i></a></li> <li><a href="https://itunes.apple.com/us/podcast/yegor256-podcast/id1150826721" rel="nofollow" title="My iTunes podcast"><i class="icon icon-itunes notranslate" aria-hidden="true"></i></a></li> <li><a href="https://t.me/yegor256news" rel="nofollow" title="My Telegram public channel"><i class="icon icon-telegram notranslate" aria-hidden="true"></i></a></li> <li><a href="mailto:blog@yegor256.com" rel="nofollow" title="Email me any time"><i class="icon icon-mail notranslate" aria-hidden="true"></i></a></li></ul><ul class="menu"> <li><a href="/" title="Home page">Home</a></li> <li ><a href="/best.html" title="Best articles to read">12&#160;Best</a></li> <li ><a href="/contents.html" title="The contents of the entire blog">All&#160;385</a></li> <li ><a href="/teaching.html" title="My courses and lectures">Teaching</a></li> <li ><a href="/talks.html" title="Future and past conference talks">Talks</a></li> <li ><a href="/books.html" title="The books I wrote">Books</a></li> <li ><a href="/papers.html" title="My academic papers and patents">Papers</a></li> <li ><a href="/pets.html" title="My loved pet projects">Pets</a></li> <li ><a href="/award.html" title="Software quality award">Award</a></li> <li ><a href="/testimonials.html" title="What some people say about me">Testimonials</a></li> <li ><a href="/shift-m.html" title="Audio podcast about project management">Shift-M</a></li> <li ><a href="/paintings.html" title="My paintings for sale">Art</a></li> <li><a href="https://ru.yegor256.com/" title="Немного на русском языке о политике в России, Украине и мире">Политика</a></li></ul></nav><div class="search"> <form method="get" action="https://www.google.com/search" itemprop="potentialAction" itemscope="" itemtype="http://schema.org/SearchAction"> <meta itemprop="target" content="https://www.google.com/search?q={q}"/> <input name="sitesearch" value="yegor256.com" type="hidden"/> <input itemprop="query-input" type="text" id="search-query" class="field field-text" required="required" onfocus="$('.google').css('visibility', 'visible');" name="q" placeholder="Search..." autocomplete="off"/> <input type="image" src="/images/google-search-icon.svg" class="google" title="Search via Google" alt="Search via Google"/> </form></div><div class="hot"><ul></ul></div></header></div><section itemscope="" itemtype="http://schema.org/BlogPosting"><div class="wrapper"> <header><h1 itemprop="name headline mainEntityOfPage">Deployment Script vs. Rultor</h1></header> <article class="main" itemprop="articleBody"><p style="color: #C42C00;">The following text is a translation of the <a href='https://www.yegor256.com/2014/09/11/deployment-script-vs-rultor.html'>original article</a>, performed by <a href="https://chat.openai.com/">ChatGPT</a> (gpt-3.5-turbo):</p><p>Quand j’explique comment Rultor automatise les processus de déploiement/libération, très souvent j’entends quelque chose comme:</p><p>Mais j’ai déjà un script qui déploie tout automatiquement.</p><p>Cette réponse est très courante, alors j’ai décidé de résumer mes trois principaux arguments en faveur des processus de déploiement/libération automatisés de Rultor dans un article : 1) des conteneurs Docker isolés, 2) la visibilité des journaux et 3) la sécurité des informations d’identification.</p><p>Lisez à leur sujet et voyez ce que Rultor vous offre en plus de votre/vos script(s) de déploiement existant(s).</p><p>Avant de commencer avec les arguments, laissez-moi souligner que Rultor est une interface utile pour vos scripts personnalisés. Lorsque vous décidez d’automatiser le déploiement avec Rultor, vous ne jetez aucun de vos scripts existants. Vous apprenez simplement à Rultor comment les appeler.</p><p>Le premier avantage que vous obtenez une fois que vous commencez à appeler vos scripts de déploiement depuis Rultor est l’utilisation de Docker. Je suis sûr que vous savez ce qu’est Docker, mais pour ceux qui ne le savent pas, c’est un gestionnaire de “machines” virtuelles Linux. C’est un script en ligne de commande que vous appelez lorsque vous avez besoin d’exécuter un script dans une nouvelle machine virtuelle (également appelée “container”). Docker démarre le conteneur presque immédiatement et exécute votre script. La beauté de Docker est que chaque conteneur est un environnement Linux parfaitement isolé, avec son propre système de fichiers, sa mémoire, ses processus, etc.</p><p>Quand vous demandez à Rultor d’exécuter votre script de déploiement, il lance un nouveau conteneur Docker et exécute votre script là-bas. Mais quel avantage cela me procure-t-il, demandez-vous ?</p><p>Le principal avantage est que le conteneur est détruit immédiatement après l’exécution de votre script. Cela signifie que vous pouvez effectuer toute la pré-configuration à l’intérieur du conteneur sans craindre aucun conflit avec votre plateforme de travail principale. Permettez-moi de vous donner un exemple.</p><p>Je développe sur MacBook, où j’installe et désinstalle des paquets dont j’ai besoin pour le développement. En même temps, j’ai un projet qui, pour être déployé, nécessite PHP 5.3, MySQL 5.6, Phing, PHPUnit, PHPCS et xdebug. Chaque version de MacOS doit être configurée spécifiquement pour faire fonctionner ces applications, et c’est un travail qui prend du temps.</p><p>Je peux changer d’ordinateurs portables et je peux changer de versions de MacOS, mais le projet reste le même. Il nécessite toujours le même ensemble de packages pour exécuter son script de déploiement avec succès. De plus, le projet n’est plus en développement actif. Je n’ai tout simplement plus besoin de ces packages pour mon travail quotidien, car je travaille davantage avec Java maintenant. Mais lorsque j’ai besoin de faire une petite correction à ce projet PHP et de le déployer, je dois installer tous les packages PHP requis et les configurer. Ce n’est qu’après cela que je peux déployer cette petite correction.</p><p>C’est ennuyeux, pour le moins que l’on puisse dire.</p><p>Docker me donne la possibilité d’automatiser tout cela ensemble. Mon script de déploiement existant recevra un préambule, qui installera et configurera tous les packages nécessaires liés à PHP dans un conteneur Ubuntu propre. Ce préambule sera exécuté à chaque exécution de mon script de déploiement, à l’intérieur d’un conteneur Docker. Par exemple, cela pourrait ressembler à ceci:</p><p>Mon script de déploiement ressemblait à ceci avant que je commence à utiliser Rultor:</p><p>Phing test git ftp push –user “..” <br /> –passwd “..” <br /> –syncroot php/src <br /> ftp://ftp.example.com/</p><p>Just two lines. The first one is a full run of unit tests. The second one is an FTP deployment to the production server. Very simple. But this script will only work if PHP 5.3, MySQL, Phing, xdebug, PHPCS and PHPUnit are installed. Again, it’s a lot of work to install and configure them every time I upgrade my MacOS or change a laptop.</p><p>Inutile de dire que si/quand quelqu’un rejoint le projet et essaie d’exécuter mes scripts, il/elle devra refaire ce travail de pré-installation.</p><p>Donc, voici un nouveau script que j’utilise actuellement. Il est exécuté à l’intérieur d’un nouveau conteneur Docker à chaque fois.</p><p>```bashsudo apt-get install -y php5 php5-mysql mysql sudo apt-get install php-pear sudo pear channel-discover pear.phpunit.de sudo pear install phpunit/PHPUnit sudo pear install PHP_CodeSniffer sudo pecl install xdebug sudo pear channel-discover pear.phing.info sudo pear install phing/phingphing test git ftp push –user “..” <br /> –passwd “..” <br /> –syncroot php/src <br /> ftp://ftp.example.com/</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
Translation: 

```bashsudo apt-get install -y php5 php5-mysql mysql
sudo apt-get install php-pear
sudo pear channel-discover pear.phpunit.de
sudo pear install phpunit/PHPUnit
sudo pear install PHP_CodeSniffer
sudo pecl install xdebug
sudo pear channel-discover pear.phing.info
sudo pear install phing/phingphing test
git ftp push --user ".." \
 --passwd ".." \
 --syncroot php/src \
 ftp://ftp.example.com/
</code></pre></div></div><p>Évidemment, exécuter ce script sur mon MacBook (sans virtualisation) causerait beaucoup de problèmes. Eh bien, je n’ai même pas apt-get ici.</p><p>Ainsi, le premier avantage que Rultor vous offre est une isolation de votre script de déploiement dans son propre environnement virtuel. Nous devons cela principalement à Docker.</p><p>Traditionnellement, nous conservons les scripts de déploiement dans un répertoire ~/deploy et les exécutons avec un ensemble de paramètres magiques. Dans un petit projet, vous le faites vous-même et ce répertoire se trouve sur votre propre ordinateur portable. Dans un projet plus important, il y a un serveur “de déploiement” qui possède ce répertoire magique avec un ensemble de scripts qui ne peuvent être exécutés que par quelques développeurs seniors de confiance. J’ai vu cette configuration à de nombreuses reprises.</p><p>Le plus grand problème ici est la traçabilité. Il est presque impossible de savoir qui a déployé quoi et pourquoi un déploiement particulier a échoué. Les gourous du déploiement sénior se connectent simplement en SSH au serveur et exécutent ces scripts magiques avec des paramètres magiques. Les journaux sont généralement perdus et le suivi des problèmes est très difficile, voire impossible.</p><p>Rultor offre quelque chose de différent. Avec Rultor, il n’y a plus d’accès SSH aux scripts de déploiement. Tous les scripts restent dans le fichier de configuration .rultor.yml, et vous les lancez en publiant des messages dans votre système de suivi des problèmes (par exemple GitHub, JIRA ou Trac). Rultor exécute le script et publie son journal complet directement dans votre ticket. Le journal reste avec votre projet pour toujours. Vous pouvez toujours revenir au ticket sur lequel vous travailliez et vérifier pourquoi le déploiement a échoué et quelles instructions ont réellement été exécutées.</p><p>Par exemple, consultez ce problème GitHub, où je déployais une nouvelle version de Rultor lui-même et j’ai échoué quelques fois : yegor256/rultor#563. Toutes mes tentatives infructueuses sont consignées. Je peux toujours y revenir et les étudier. Pour un gros projet, cette information est vitale.</p><p>Ainsi, le deuxième avantage de Rultor par rapport à un script de déploiement autonome est la visibilité de chaque opération individuelle.</p><p>Lorsque vous avez un script personnalisé sur votre ordinateur portable ou sur ce serveur de déploiement d’équipe secret, vos identifiants de production restent à proximité. Il n’y a tout simplement pas d’autre moyen. Si votre logiciel fonctionne avec une base de données, il doit connaître les identifiants de connexion (nom d’utilisateur, mot de passe, nom de la base de données, numéro de port, etc.). Eh bien, dans le pire des cas, certaines personnes codent simplement ces informations directement dans le code source. Nous n’allons même pas discuter de ce cas, c’est à quel point c’est mauvais.</p><p>Mais disons que vous séparez vos identifiants de base de données du code source. Vous aurez quelque chose comme un fichier db.properties ou db.ini, qui sera attaché à l’application juste avant le déploiement. Vous pouvez également conserver ce fichier directement sur le serveur de production, ce qui est encore mieux, mais pas toujours possible, surtout avec les déploiements PaaS, par exemple.</p><p>Un problème similaire existe avec le déploiement d’artefacts dans des dépôts. Disons que vous déployez régulièrement sur RubyGems.org. Vos ~/.gem/credentials contiendront votre clé d’API secrète.</p><p>Donc, très souvent, vos scripts de déploiement sont accompagnés de certains fichiers contenant des informations sensibles et sécurisées. Et ces fichiers contiennent ces informations dans un format ouvert et simple. Pas de chiffrement, pas de protection. Juste des noms d’utilisateur, des mots de passe, des codes et des jetons en texte clair.</p><p>Pourquoi est-ce mauvais ? Eh bien, pour un développeur seul avec un seul ordinateur portable, cela ne semble pas être un problème. Bien que je n’aime pas l’idée de perdre un ordinateur portable quelque part dans un aéroport avec toutes les informations d’identification ouvertes et prêtes à être utilisées. Vous pourriez argumenter qu’il existe des outils de protection des disques, comme FileVault pour MacOS ou BestCrypt pour Windows. Oui, peut-être.</p><p>Mais voyons ce qui se passe lorsque nous avons une équipe de développeurs qui travaillent ensemble et partagent ces scripts de déploiement et fichiers avec les informations d’identification. Une fois que vous donnez accès à vos scripts de déploiement à un nouveau membre de l’équipe, vous devez partager toutes ces données sensibles. Il n’y a tout simplement pas moyen de contourner cela. Pour pouvoir utiliser les scripts, il/elle doit être en mesure d’ouvrir les fichiers avec les informations d’identification.</p><p>C’est un problème, si vous vous souciez de la sécurité de vos données.</p><p>Rultor résout ce problème en offrant un déchiffrement GPG à la volée de vos données sensibles, juste avant qu’elles ne soient utilisées par vos scripts de déploiement. Dans le fichier de configuration .rultor.yml, vous indiquez simplement :</p><p>Please, translate this paragraph from English to French, don’t change proper nouns:</p><p>text decrypt: db.ini: “repo/db.ini.asc” deploy: script: ftp put db.ini production</p><p>Ensuite, vous chiffrez votre db.ini à l’aide d’une clé Rultor GPG et vous commettez sans crainte db.ini.asc dans le dépôt. Personne ne pourra ouvrir et lire ce fichier, sauf le serveur Rultor lui-même, juste avant d’exécuter le script de déploiement.</p><p>Ainsi, le troisième avantage de Rultor par rapport à un script de déploiement autonome est la sécurité appropriée des données sensibles.</p><p class="jekyll-chatgpt-translate">Translated by ChatGPT gpt-3.5-turbo/0.0.14</p></article></div><div class="wrapper"> <footer class="footer"><p> &copy; <span itemscope="" itemprop="copyrightHolder" itemtype="http://schema.org/Person"> <span itemprop="name">Yegor Bugayenko</span> </span> 2014&ndash;<span itemprop="copyrightYear">2023</span></p></footer></div></section><div class="wrapper unprintable" style="text-align:center;margin-top:2em;"> <a href="https://www.sixnines.io/h/3ba1652f"> <img src="//www.sixnines.io/b/3ba1652f?style=flat" alt="sixnines availability badge" /></a> &nbsp; <a href="https://github.com/yegor256/blog/stargazers"> <img src="//img.shields.io/github/stars/yegor256/blog.svg?style=flat-square" alt="GitHub stars" /></a></div><script src="//code.jquery.com/jquery-1.9.0.min.js"></script> <script src="/js/all.js?3a3b5d6c83f"></script> <script>var disqus_shortname = 'yegor256';</script> <script id="dsq-count-scr" src="//yegor256.disqus.com/count.js" async="async"></script> <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','//www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-1963507-32', 'auto'); ga('send', 'pageview'); </script> <script> Cd=document;Cr="&"+Math.random();Cp="&s=1"; Cd.cookie="b=b";if(Cd.cookie)Cp+="&c=1"; Cp+="&t="+(new Date()).getTimezoneOffset(); if(self!=top)Cp+="&f=1"; </script> <script> if(navigator.javaEnabled())Cp+="&j=1"; </script> <script> if(typeof(screen)!='undefined')Cp+="&w="+screen.width+"&h="+ screen.height+"&d="+(screen.colorDepth?screen.colorDepth:screen.pixelDepth); </script> <script> Cd.write("<img src='//c.hit.ua/hit?i=95870&g=0&x=2"+Cp+Cr+ "&r="+escape(Cd.referrer)+"&u="+escape(window.location.href)+ "' border='0' wi"+"dth='1' he"+"ight='1'/>"); </script> <script type="application/ld+json"> { "@context": "http://schema.org", "@type": "Person", "name": "Yegor Bugayenko", "url": "https://www.yegor256.com", "sameAs": [ "https://www.facebook.com/yegor256", "https://instagram.com/yegor256", "https://www.linkedin.com/in/yegor256", "https://twitter.com/yegor256", "https://github.com/yegor256", "https://www.pinterest.com/yegor256/" ] } </script> </body> </html>
