<!DOCTYPE html>
<html amp lang="en">
  <head>

    <meta charset="utf-8">
    <title>How to Release to Maven Central, in One Click</title>
    <link rel="canonical" href="https://www.yegor256.com/2014/08/19/how-to-release-to-maven-central.html">
    <link rel="icon" type="image/png" href="/favicon.ico">
    <meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1">
    <script type="application/ld+json">
      {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "mainEntityOfPage":{
          "@type": "WebPage",
          "@id": "https://www.yegor256.com/2014/08/19/how-to-release-to-maven-central.html"
        },
        "headline": "How to Release to Maven Central, in One Click",
        "image": {
          "@type": "ImageObject",
          "url": "https://www.yegor256.com/images/face-1200x1200.jpg",
          "height": 1400,
          "width": 1400
        },
        "datePublished": "2014-08-19",
        "dateModified": "2014-08-19",
        "author": {
          "@type": "Person",
          "name": "Yegor Bugayenko"
        },
        "publisher": {
          "@type": "Organization",
          "name": "yegor256.com",
          "logo": {
            "@type": "ImageObject",
            "url": "https://www.yegor256.com/images/face-512x512.jpg",
            "width": 512,
            "height": 512
          }
        },
        "description": "This tutorial explains how a Java project can be
released/deployed to Maven Central in just one click and
zero maintenance efforts, using Rultor.com, DevOps assistant
",
        "keywords": ["release to maven central", "how to release to maven central", "deploy to maven central", "how to deploy to maven central", "maven central release", "fast release to maven central", "publish from github to maven central"]
      }
    </script>
    <style amp-boilerplate>body{-webkit-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-moz-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-ms-animation:-amp-start 8s steps(1,end) 0s 1 normal both;animation:-amp-start 8s steps(1,end) 0s 1 normal both}@-webkit-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-moz-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-ms-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-o-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}</style>
<noscript><style amp-boilerplate>body{-webkit-animation:none;-moz-animation:none;-ms-animation:none;animation:none}</style></noscript>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Code+Pro:400,500">
    <style amp-custom="amp-custom">
      @font-face {
        font-family: 'Cambria';
        src: url('https://www.yegor256.com/fonts/cambria/2EAA54_2_0.ttf');
      }
      body { font-family: 'Cambria', 'Times New Roman', serif; padding: .5em; font-size: 1.2em; }
      article { width: 600px; max-width: 100%; margin-left: auto; margin-right: auto; }
      pre, code { font-family: 'Source Code Pro', 'Courier New', monospace; font-size: .8em; }
      code { padding: 0 .3em; background-color: lightgray; }
      a, a:hover, a:visited { color: inherit; }
      .intro { color: red; font-size: .75em; }
      .photo { border-radius: 50%; }
      pre { overflow-x:scroll; }
    </style>
    <script async src="https://cdn.ampproject.org/v0.js"></script>
  </head>
  <body>
    <article>
      <p class="intro">
        This is a mobile version, full one is
        <a href="https://www.yegor256.com/2014/08/19/how-to-release-to-maven-central.html">here</a>.
      </p>
      <p>
        <amp-img src="/images/face-256x256.jpg" width="80" height="80" alt="Yegor Bugayenko" class="photo"></amp-img>
      </p>
      <p>Yegor Bugayenko<br>19 August 2014</p>
      <h1>How to Release to Maven Central, in One Click</h1>
      <p>When I release a new version of <a href="http://aspects.jcabi.com">jcabi-aspects</a>,
a Java open source library, to Maven Central, it takes 30 seconds of my time.
Maybe even less. Recently, I released version 0.17.2. You can see
how it all happened, in <a href="https://github.com/jcabi/jcabi-aspects/issues/80">GitHub issue #80</a>:</p>



<p>As you see, I gave a command to <a href="http://www.rultor.com">Rultor</a>,
and it released a new version to Maven central. I didn’t do anything else.</p>

<p>Now let’s see how you can do the same. How you can configure your project
so that the release of its new version to Maven Central
takes just a few seconds of your time.</p>



<p>By the way, I assume that you’re hosting your project in GitHub. If not,
this entire tutorial won’t work. If you are still not in GitHub, I would
strongly recommend moving there.</p>

<h2 id="prepare-your-pom">Prepare Your POM</h2>



<p>Make sure your <code class="highlighter-rouge">pom.xml</code> contains all elements required by Sonatype,
explained in <a href="http://central.sonatype.org/pages/requirements.html">Central Sync Requirements</a>.
We will deploy to Sonatype, and they will synchronize all JAR (and not only)
artifacts to Maven Central.</p>

<h2 id="register-a-project-with-sonatype">Register a Project With Sonatype</h2>

<p>Create an account in <a href="https://issues.sonatype.org/">Sonatype JIRA</a>
and raise a ticket, asking to approve your <code class="highlighter-rouge">groupId</code>. This
<a href="http://central.sonatype.org/pages/ossrh-guide.html">OSSRH Guide</a>
explains this step in more detail.</p>

<h2 id="create-and-distribute-a-gpg-key">Create and Distribute a GPG Key</h2>

<p>Create a GPG key and distribute it, as explained in this
<a href="http://central.sonatype.org/pages/working-with-pgp-signatures.html">Working with PGP Signatures</a>
article.</p>

<p>When this step is done, you should have two files:
<code class="highlighter-rouge">pubring.gpg</code> and <code class="highlighter-rouge">secring.gpg</code>.</p>

<h2 id="create-settingsxml">Create settings.xml</h2>

<p>Create <code class="highlighter-rouge">settings.xml</code>, next to the two <code class="highlighter-rouge">.gpg</code> files created in the previous step:</p>

<pre>&lt;settings&gt;
  &lt;profiles&gt;
    &lt;profile&gt;
      &lt;id&gt;foo&lt;/id&gt; &lt;!-- give it the name of your project --&gt;
      &lt;properties&gt;
        &lt;gpg.homedir&gt;/home/r&lt;/gpg.homedir&gt;
        &lt;gpg.keyname&gt;9A105525&lt;/gpg.keyname&gt;
        &lt;gpg.passphrase&gt;my-secret&lt;/gpg.passphrase&gt;
      &lt;/properties&gt;
    &lt;/profile&gt;
  &lt;/profiles&gt;
  &lt;servers&gt;
    &lt;server&gt;
      &lt;id&gt;oss.sonatype.org&lt;/id&gt;
      &lt;username&gt;&lt;!-- Sonatype JIRA user name --&gt;&lt;/username&gt;
      &lt;password&gt;&lt;!-- Sonatype JIRA pwd --&gt;&lt;/password&gt;
    &lt;/server&gt;
  &lt;/servers&gt;
&lt;/settings&gt;</pre>

<p>In this example, <code class="highlighter-rouge">9A105525</code> is the ID of your public key, and <code class="highlighter-rouge">my-secret</code>
is the pass phrase you have used while generating the keys.</p>

<h2 id="encrypt-security-assets">Encrypt Security Assets</h2>

<p>Now, encrypt these three files with a <a href="https://github.com/yegor256/rultor-remote">rultor remote</a>:</p>

<pre>$ gem install rultor
$ rultor encrypt -p me/test pubring.gpg
$ rultor encrypt -p me/test secring.gpg
$ rultor encrypt -p me/test settings.xml</pre>

<p>Instead of <code class="highlighter-rouge">me/test</code> you should use the name of your GitHub project.</p>

<p>You will get three new files: <code class="highlighter-rouge">pubring.gpg.asc</code>, <code class="highlighter-rouge">secring.gpg.asc</code>
and <code class="highlighter-rouge">settings.xml.asc</code>. Add them to the root directory of your project,
commit and push. The files contain your secret information,
but only the Rultor server can decrypt them.</p>

<h2 id="add-sonatype-repositories">Add Sonatype Repositories</h2>

<p>I would recommend using <a href="/2015/02/05/jcabi-parent-maven-pom.html">jcabi-parent</a>, as
a parent pom for your project. This will make many further steps
unnecessary. If you’re using jcabi-parent, skip this step.</p>

<p>However, if you don’t use jcabi-parent, you should add these two repositories
to your <code class="highlighter-rouge">pom.xml</code>:</p>

<pre>&lt;project&gt;
  [...]
  &lt;distributionManagement&gt;
    &lt;repository&gt;
      &lt;id&gt;oss.sonatype.org&lt;/id&gt;
      &lt;url&gt;https://oss.sonatype.org/service/local/staging/deploy/maven2/&lt;/url&gt;
    &lt;/repository&gt;
    &lt;snapshotRepository&gt;
      &lt;id&gt;oss.sonatype.org&lt;/id&gt;
      &lt;url&gt;https://oss.sonatype.org/content/repositories/snapshots&lt;/url&gt;
    &lt;/snapshotRepository&gt;
  &lt;/distributionManagement&gt;
&lt;/project&gt;</pre>

<h2 id="configure-gpg-plugin">Configure GPG Plugin</h2>

<p>Again, I’d recommend using <a href="http://parent.jcabi.com">jcabi-parent</a>,
which configures this plugin automatically. If you’re using it, skip this step.</p>

<p>Otherwise, add this plugin to your <code class="highlighter-rouge">pom.xml</code>:</p>

<pre>&lt;project&gt;
  [..]
  &lt;build&gt;
    [..]
    &lt;plugins&gt;
      [..]
      &lt;plugin&gt;
        &lt;artifactId&gt;maven-gpg-plugin&lt;/artifactId&gt;
        &lt;version&gt;1.5&lt;/version&gt;
        &lt;executions&gt;
          &lt;execution&gt;
            &lt;id&gt;sign-artifacts&lt;/id&gt;
            &lt;phase&gt;verify&lt;/phase&gt;
            &lt;goals&gt;
              &lt;goal&gt;sign&lt;/goal&gt;
            &lt;/goals&gt;
          &lt;/execution&gt;
        &lt;/executions&gt;
      &lt;/plugin&gt;
    &lt;/plugins&gt;
  &lt;/build&gt;
&lt;/project&gt;</pre>

<h2 id="configure-versions-plugin">Configure Versions Plugin</h2>

<p>Once again, I recommend using <a href="/2015/02/05/jcabi-parent-maven-pom.html">http://parent.jcabi.com</a>. It
configures all required plugins out-of-the-box. If you’re using it, skip this step.</p>

<p>Otherwise, add this plugin to your <code class="highlighter-rouge">pom.xml</code>:</p>

<pre>&lt;project&gt;
  [..]
  &lt;build&gt;
    [..]
    &lt;plugins&gt;
      [..]
      &lt;plugin&gt;
        &lt;groupId&gt;org.codehaus.mojo&lt;/groupId&gt;
        &lt;artifactId&gt;versions-maven-plugin&lt;/artifactId&gt;
        &lt;version&gt;2.1&lt;/version&gt;
        &lt;configuration&gt;
          &lt;generateBackupPoms&gt;false&lt;/generateBackupPoms&gt;
        &lt;/configuration&gt;
      &lt;/plugin&gt;
    &lt;/plugins&gt;
  &lt;/build&gt;
&lt;/project&gt;</pre>

<h2 id="configure-sonatype-plugin">Configure Sonatype Plugin</h2>

<p>Yes, you’re right, <a href="/2015/02/05/jcabi-parent-maven-pom.html">http://parent.jcabi.com</a> will help
you here as well. If you’re using it, skip this step too.</p>

<p>Otherwise, add these four plugins to your <code class="highlighter-rouge">pom.xml</code>:</p>

<pre>&lt;project&gt;
  [..]
  &lt;build&gt;
    [..]
    &lt;plugins&gt;
      [..]
      &lt;plugin&gt;
        &lt;artifactId&gt;maven-deploy-plugin&lt;/artifactId&gt;
        &lt;configuration&gt;
          &lt;skip&gt;true&lt;/skip&gt;
        &lt;/configuration&gt;
      &lt;/plugin&gt;
      &lt;plugin&gt;
        &lt;artifactId&gt;maven-source-plugin&lt;/artifactId&gt;
        &lt;executions&gt;
          &lt;execution&gt;
            &lt;id&gt;package-sources&lt;/id&gt;
            &lt;goals&gt;
              &lt;goal&gt;jar&lt;/goal&gt;
            &lt;/goals&gt;
          &lt;/execution&gt;
        &lt;/executions&gt;
      &lt;/plugin&gt;
      &lt;plugin&gt;
        &lt;artifactId&gt;maven-javadoc-plugin&lt;/artifactId&gt;
        &lt;executions&gt;
          &lt;execution&gt;
            &lt;id&gt;package-javadoc&lt;/id&gt;
            &lt;phase&gt;package&lt;/phase&gt;
            &lt;goals&gt;
              &lt;goal&gt;jar&lt;/goal&gt;
            &lt;/goals&gt;
          &lt;/execution&gt;
        &lt;/executions&gt;
      &lt;/plugin&gt;
      &lt;plugin&gt;
        &lt;groupId&gt;org.sonatype.plugins&lt;/groupId&gt;
        &lt;artifactId&gt;nexus-staging-maven-plugin&lt;/artifactId&gt;
        &lt;version&gt;1.6&lt;/version&gt;
        &lt;extensions&gt;true&lt;/extensions&gt;
        &lt;configuration&gt;
          &lt;serverId&gt;oss.sonatype.org&lt;/serverId&gt;
          &lt;nexusUrl&gt;https://oss.sonatype.org/&lt;/nexusUrl&gt;
          &lt;description&gt;${project.version}&lt;/description&gt;
        &lt;/configuration&gt;
        &lt;executions&gt;
          &lt;execution&gt;
            &lt;id&gt;deploy-to-sonatype&lt;/id&gt;
            &lt;phase&gt;deploy&lt;/phase&gt;
            &lt;goals&gt;
              &lt;goal&gt;deploy&lt;/goal&gt;
              &lt;goal&gt;release&lt;/goal&gt;
            &lt;/goals&gt;
          &lt;/execution&gt;
        &lt;/executions&gt;
      &lt;/plugin&gt;
    &lt;/plugins&gt;
  &lt;/build&gt;
&lt;/project&gt;</pre>

<h2 id="create-rultor-configuration">Create Rultor Configuration</h2>

<p>Create a <code class="highlighter-rouge">.rultor.yml</code> file in the root directory of your project
(<a href="https://doc.rultor.com/reference.html">reference page</a>
explains this format in details):</p>

<pre>decrypt:
  settings.xml: "repo/settings.xml.asc"
  pubring.gpg: "repo/pubring.gpg.asc"
  secring.gpg: "repo/secring.gpg.asc"
release:
  script: |
    mvn versions:set "-DnewVersion=${tag}"
    git commit -am "${tag}"
    mvn clean deploy -Pjcabi --settings /home/r/settings.xml</pre>

<p>You can compare your file with live Rultor
<a href="https://github.com/jcabi/jcabi-aspects/blob/master/.rultor.yml">configuration of jcabi-aspects</a>.</p>

<h2 id="run-it">Run It!</h2>



<p>Now it’s time to see how it all works. Create a new ticket in the
GitHub issue tracker, and post something like that into it
(read more about <a href="https://doc.rultor.com/basics.html">Rultor commands</a>):</p>

<pre>@rultor release, tag is `0.1`</pre>

<p>You will get a response in a few seconds. The rest will be done by Rultor.</p>

<p>Enjoy :)</p>

<p>BTW, if something doesn’t work as I’ve explained, don’t hesitate to
submit a ticket to
<a href="https://github.com/yegor256/rultor/issues">Rultor issue tracker</a>.
I will try to help you.</p>

<p>Yeah, forgot to mention, Rultor is also doing two important things. First,
it creates a GitHub release with a proper description. Second, it
posts a tweet about the release, which you can retweet, to make
an announcement to your followers. Both features are very convenient
for me. For example:</p>

<blockquote class="twitter-tweet" lang="en">
<p>DynamoDB Local Maven Plugin, 0.7.1 released <a href="https://t.co/C3KULouuKS">https://t.co/C3KULouuKS</a></p>---rultor.com (@rultors) <a href="https://twitter.com/rultors/statuses/501617747269517312">August 19, 2014</a>
</blockquote>



    </article>
  </body>
</html>
