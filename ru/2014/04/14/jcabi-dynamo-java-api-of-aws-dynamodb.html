<!DOCTYPE html> <html xmlns="http://www.w3.org/1999/xhtml" lang="en-US" xml:lang="en-US" itemscope="" itemtype="http://schema.org/WebSite"> <head> <meta charset="utf-8"/> <meta name="description" content="I created jcabi-dynamo a few months ago to make AWS SDK more object oriented; the article explains why jcabi-dynamo is better than bare Amazon SDK" /> <meta name="keywords" content="" /> <meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1"/> <meta name="google-site-verification" content="JEj_gQr2CPe2QKGw8XdMz0R7VboQIUbX3FlM-lwTq-8" /> <meta name="author" content="Yegor Bugayenko"> <meta name="og:site_name" content="Yegor Bugayenko"/> <meta name="og:type" content="article" /> <meta name="og:locale" content="en_US" /> <meta name="twitter:account_id" content="4503599630178231" /> <meta name="twitter:creator" content="@yegor256"/> <meta name="twitter:site" content="@yegor256"/> <meta name="twitter:title" property="og:title" content="Object-Oriented DynamoDB API"/> <meta name="twitter:description" property="og:description" content="I created jcabi-dynamo a few months ago to make AWS SDK more object oriented; the article explains why jcabi-dynamo is better than bare Amazon SDK"/> <meta name="twitter:url" property="og:url" content="https://www.yegor256.com/ru/2014/04/14/jcabi-dynamo-java-api-of-aws-dynamodb.html"/> <meta name="telegram:channel" content="AAAAAEJFMRzsRTRxM3ec6A"/> <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="yegor256" /> <link rel="shortcut icon" href="/favicon.ico?6c62e4ddc32"/> <link rel="apple-touch-icon" href="/favicon.ico?6c62e4ddc32"/> <link rel="alternate" type="application/rss+xml" title="RSS for yegor256.com" href="https://www.yegor256.com/rss.xml"/> <link rel="stylesheet" href="/css/layout.css?6c62e4ddc32"/> <link rel="stylesheet" href="/css/icons.css?6c62e4ddc32"/> <link rel="canonical" href="https://www.yegor256.com/ru/2014/04/14/jcabi-dynamo-java-api-of-aws-dynamodb.html" /> <title>Object-Oriented DynamoDB API</title> </head> <body><div class="wrapper"> <aside class="header-toggle unprintable" id="header-toggle" title="Show the menu" onclick="$('#header').show();$('#header-toggle').hide();">&#9776;</aside> <header class="header" id="header"><div class="face"> <a href="/about-me.html#form" class="sub" title="Click to subscribe to my monthly newsletter"><span>Subscribe</span></a> <a href="/about-me.html" style="position:relative;"> <img src="/images/face-256x256.jpg" class="photo" alt="Yegor Bugayenko"/> </a></div><nav><ul class="menu social notranslate"> <li><a href="https://twitter.com/intent/follow?screen_name=yegor256" rel="nofollow" title="Follow me on Twitter"><i class="icon icon-twitter notranslate" aria-hidden="true"></i></a></li> <li><a href="/rss.xml" rel="nofollow" title="Subscribe to my RSS feed"><i class="icon icon-rss notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://github.com/yegor256" rel="nofollow" title="My GitHub profile"><i class="icon icon-github notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="http://stackoverflow.com/users/187141/yegor256" rel="nofollow" title="My Stack Overflow profile"><i class="icon icon-stackoverflow notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.facebook.com/yegor256" rel="nofollow" title="Follow me on Facebook"><i class="icon icon-facebook notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://instagram.com/yegor256" rel="nofollow" title="Follow me on Instagram"><i class="icon icon-instagram notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.linkedin.com/in/yegor256" rel="nofollow" title="My LinkedIn profile"><i class="icon icon-linkedin notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.youtube.com/c/yegor256?sub_confirmation=1" rel="nofollow" title="My Youtube video channel"><i class="icon icon-youtube notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.pinterest.com/yegor256/" rel="nofollow" title="My Pinterest boards"><i class="icon icon-pinterest notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://angel.co/yegor256" rel="nofollow" title="My AngelList profile"><i class="icon icon-angellist notranslate" aria-hidden="true"></i></a></li> <li><a href="https://soundcloud.com/yegor256" rel="nofollow" title="My podcast"><i class="icon icon-podcast notranslate" aria-hidden="true"></i></a></li> <li><a href="https://itunes.apple.com/us/podcast/yegor256-podcast/id1150826721" rel="nofollow" title="My iTunes podcast"><i class="icon icon-itunes notranslate" aria-hidden="true"></i></a></li> <li><a href="https://t.me/yegor256news" rel="nofollow" title="My Telegram public channel"><i class="icon icon-telegram notranslate" aria-hidden="true"></i></a></li> <li><a href="mailto:blog@yegor256.com" rel="nofollow" title="Email me any time"><i class="icon icon-mail notranslate" aria-hidden="true"></i></a></li></ul><ul class="menu"> <li><a href="/" title="Home page">Home</a></li> <li ><a href="/best.html" title="Best articles to read">12&#160;Best</a></li> <li ><a href="/contents.html" title="The contents of the entire blog">All&#160;388</a></li> <li ><a href="/teaching.html" title="My courses and lectures">Teaching</a></li> <li ><a href="/talks.html" title="Future and past conference talks">Talks</a></li> <li ><a href="/books.html" title="The books I wrote">Books</a></li> <li ><a href="/research.html" title="My research directions and progress">Research</a></li> <li ><a href="/pets.html" title="My loved pet projects">Pets</a></li> <li ><a href="/testimonials.html" title="What some people say about me">Testimonials</a></li> <li ><a href="/shift-m.html" title="Audio podcast about project management">Shift-M</a></li> <li ><a href="/paintings.html" title="My paintings for sale">Art</a></li> <li><a href="https://ru.yegor256.com/" title="Немного на русском языке о политике в России, Украине и мире">Политика</a></li></ul></nav><div class="search"> <form method="get" action="https://www.google.com/search" itemprop="potentialAction" itemscope="" itemtype="http://schema.org/SearchAction"> <meta itemprop="target" content="https://www.google.com/search?q={q}"/> <input name="sitesearch" value="yegor256.com" type="hidden"/> <input itemprop="query-input" type="text" id="search-query" class="field field-text" required="required" onfocus="$('.google').css('visibility', 'visible');" name="q" placeholder="Search..." autocomplete="off"/> <input type="image" src="/images/google-search-icon.svg" class="google" title="Search via Google" alt="Search via Google"/> </form></div><div class="hot"><ul></ul></div></header></div><section itemscope="" itemtype="http://schema.org/BlogPosting"><div class="wrapper"> <header><h1 itemprop="name headline mainEntityOfPage">Object-Oriented DynamoDB API</h1></header> <article class="main" itemprop="articleBody" style="font-family: sans-serif; font-size: 0.9em; line-height: 1.2em;"><p style="color: #C42C00;">The following text is a <em>partial</em> translation of the <a href='https://www.yegor256.com/2014/04/14/jcabi-dynamo-java-api-of-aws-dynamodb.html'>original English article</a>, performed by <a href="https://chat.openai.com/">ChatGPT</a> (gpt-3.5-turbo) and <a href="https://github.com/yegor256/jekyll-chatgpt-translate">this Jekyll plugin</a>:</p><p>Я являюсь большим поклонником облачных вычислений в общем и <a href="http://aws.amazon.com/">Amazon Web Services</a> в частности. Я искренне верю, что через несколько лет крупные провайдеры будут хостить все или почти все вычислительные и хранилищеские ресурсы. Когда это произойдет, нам не придется слишком беспокоиться о простое, резервных копиях и системных администраторах. <a href="http://aws.amazon.com/dynamodb/">DynamoDB</a> - это один из шагов к этому будущему.</p><blockquote class="twitter-tweet" data-lang="en"><p lang="en" dir="ltr">This looks cool - jcabi-dynamo - a <a href="https://twitter.com/hashtag/Java?src=hash&amp;ref_src=twsrc%5Etfw">#Java</a> Object layer atop the <a href="https://twitter.com/hashtag/DynamoDB?src=hash&amp;ref_src=twsrc%5Etfw">#DynamoDB</a> SDK - <a href="http://t.co/khRFR2joKX">http://t.co/khRFR2joKX</a> <a href="https://twitter.com/hashtag/aws?src=hash&amp;ref_src=twsrc%5Etfw">#aws</a></p>&mdash; Jeff Barr ☁️ (@jeffbarr) <a href="https://twitter.com/jeffbarr/status/380813867971915777?ref_src=twsrc%5Etfw">September 19, 2013</a></blockquote> <script async="" src="https://platform.twitter.com/widgets.js" charset="utf-8"></script><p>DynamoDB - это база данных <a href="http://en.wikipedia.org/wiki/NoSQL">NoSQL</a>, доступная через <a href="http://en.wikipedia.org/wiki/Representational_state_transfer">RESTful</a> JSON API. Ее дизайн относительно прост. Есть таблицы, которые в основном являются сборниками структур данных, или в терминологии AWS - “элементами”.</p><p>Каждый элемент имеет обязательный “хеш”, необязательный “диапазон” и несколько других необязательных атрибутов. Например, возьмем таблицу <code class="language-plaintext highlighter-rouge">depts</code>.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>+------+--------+---------------------------+
| dept | worker | Attributes                |
+------+--------+---------------------------+
| 205  | Jeff   | job="manager", sex="male" |
| 205  | Bob    | age=43, city="Chicago"    |
| 398  | Alice  | age=27, job="architect"   |
+------+--------+---------------------------+
</code></pre></div></div><p>Для Java Amazon предоставляет <a href="https://aws.amazon.com/documentation/sdkforjava/">SDK</a>, который отображает все RESTful вызовы на методы Java. SDK работает нормально, но создан в чистом процедурном стиле.</p><p>Давайте скажем, что мы хотим добавить новый элемент в таблицу выше. RESTful вызов <a href="http://docs.aws.amazon.com/amazondynamodb/latest/APIReference/API_PutItem.html"><code class="language-plaintext highlighter-rouge">putItem</code></a> выглядит так (в сущности):</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>putItem:
  tableName: depts
  item:
    dept: 435
    worker: "William"
    job: "programmer"
</code></pre></div></div><p>Это то, что сервер Amazon должен знать, чтобы создать новый элемент в таблице. Вот как вы должны сделать этот вызов через AWS Java SDK:</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>PutItemRequest request = new PutItemRequest();
request.setTableName("depts");
Map&lt;String, AttributeValue&gt; attributes = new HashMap&lt;&gt;();
attributes.put("dept", new AttributeValue(435));
attributes.put("worker", new AttributeValue("William"));
attributes.put("job", new AttributeValue("programmer));
request.setItem(attributes);
AmazonDynamoDB aws = // instantiate it with credentials
try {
  aws.putItem(request);
} finally {
  aws.shutdown();
}
</code></pre></div></div><p>Вышеуказанный скрипт работает нормально, но есть один крупный недостаток — он не является объектно-ориентированным. Это отличный пример императивного <a href="http://en.wikipedia.org/wiki/Procedural_programming">процедурного программирования</a>.</p><p>Чтобы вы могли сравнить, позвольте мне показать, что я сделал с <a href="http://dynamo.jcabi.com">jcabi-dynamo</a>. Вот мой код, который делает точно то же самое, но в <a href="http://ru.wikipedia.org/wiki/%D0%9E%D0%B1%D1%8A%D0%B5%D0%BA%D1%82%D0%BD%D0%BE-%D0%BE%D1%80%D0%B8%D0%B5%D0%BD%D1%82%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%BD%D0%BE%D0%B5_%D0%BF%D1%80%D0%BE%D0%B3%D1%80%D0%B0%D0%BC%D0%BC%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5">объектно-ориентированном</a> стиле:</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Region region = // instantiate it with credentials
Table table = region.table("depts");
Item item = table.put(
  new Attributes()
    .with("dept", 435)
    .with("worker", "William")
    .with("job", "programmer")
);
</code></pre></div></div><p>Мой код не только короче, но он также использует инкапсуляцию и разделяет обязанности классов. Класс <a href="http://dynamo.jcabi.com/apidocs-0.10/com/jcabi/dynamo/Table.html"><code class="language-plaintext highlighter-rouge">Table</code></a> (в действительности это интерфейс, реализованный внутри класса) инкапсулирует информацию о таблице, в то время как класс <a href="http://dynamo.jcabi.com/apidocs-0.10/com/jcabi/dynamo/Item.html"><code class="language-plaintext highlighter-rouge">Item</code></a> инкапсулирует детали элемента.</p><p>Мы можем передать <code class="language-plaintext highlighter-rouge">item</code> в качестве аргумента в другой метод, и все детали реализации, связанные с DynamoDB, будут скрыты от него. Например, где-то позже в коде:</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>void sayHello(Item item) {
  System.out.println("Hello, " + item.get("worker"));
}
</code></pre></div></div><p>В этом скрипте мы ничего не знаем о DynamoDB или о том, как работать с его RESTful API. Мы взаимодействуем только с экземпляром класса <a href="http://dynamo.jcabi.com/apidocs-0.10/com/jcabi/dynamo/Item.html"><code class="language-plaintext highlighter-rouge">Item</code></a>.</p><p>Кстати, все общедоступные сущности в <a href="http://dynamo.jcabi.com">jcabi-dynamo</a> являются интерфейсами Java. Благодаря этому вы можете полностью тестировать и подделывать библиотеку (но я бы рекомендовал использовать DynamoDB Local и создавать интеграционные тесты).</p><p>Давайте рассмотрим более сложный пример, который занял бы целую страницу кода, если бы мы использовали обычный AWS SDK. Предположим, что мы хотим удалить всех работников из нашей таблицы, которые работают как архитекторы.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Region region = // instantiate it with credentials
Iterator&lt;Item&gt; workers = region.table("depts").frame()
  .where("job", Condition.equalTo("architect"));
while (workers.hasNext()) {
  workers.remove();
}
</code></pre></div></div><p><a href="http://dynamo.jcabi.com">jcabi-dynamo</a> сэкономил много строк кода в нескольких моих проектах. Вы можете увидеть его в действии на <a href="https://github.com/rultor/rultor/tree/rultor-0.2/rultor-users/src/main/java/com/rultor/users">rultor-users</a>.</p><p>Библиотека поставляется в виде зависимости JAR в <a href="https://repo1.maven.org/maven2/com/jcabi/jcabi-dynamo">Maven Central</a> (получите последние версии из <a href="http://search.maven.org/">Maven Central</a>).</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;dependency&gt;
  &lt;groupId&gt;com.jcabi&lt;/groupId&gt;
  &lt;artifactId&gt;jcabi-dynamo&lt;/artifactId&gt;
&lt;/dependency&gt;
</code></pre></div></div><p class="jekyll-chatgpt-translate">Translated by ChatGPT gpt-3.5-turbo/35 on 2023-09-20 at 20:38</p></article></div><div class="wrapper"> <footer class="footer"><p> &copy; <span itemscope="" itemprop="copyrightHolder" itemtype="http://schema.org/Person"> <span itemprop="name">Yegor Bugayenko</span> </span> 2014&ndash;<span itemprop="copyrightYear">2023</span></p></footer></div></section><div class="wrapper unprintable" style="text-align:center;margin-top:2em;"> <a href="https://www.sixnines.io/h/3ba1652f"> <img src="//www.sixnines.io/b/3ba1652f?style=flat" alt="sixnines availability badge" /></a> &nbsp; <a href="https://github.com/yegor256/blog/stargazers"> <img src="//img.shields.io/github/stars/yegor256/blog.svg?style=flat-square" alt="GitHub stars" /></a></div><script src="//code.jquery.com/jquery-1.9.0.min.js"></script> <script src="/js/all.js?6c62e4ddc32"></script> <script>var disqus_shortname = 'yegor256';</script> <script id="dsq-count-scr" src="//yegor256.disqus.com/count.js" async="async"></script> <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','//www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-1963507-32', 'auto'); ga('send', 'pageview'); </script> <script> Cd=document;Cr="&"+Math.random();Cp="&s=1"; Cd.cookie="b=b";if(Cd.cookie)Cp+="&c=1"; Cp+="&t="+(new Date()).getTimezoneOffset(); if(self!=top)Cp+="&f=1"; </script> <script> if(navigator.javaEnabled())Cp+="&j=1"; </script> <script> if(typeof(screen)!='undefined')Cp+="&w="+screen.width+"&h="+ screen.height+"&d="+(screen.colorDepth?screen.colorDepth:screen.pixelDepth); </script> <script> Cd.write("<img src='//c.hit.ua/hit?i=95870&g=0&x=2"+Cp+Cr+ "&r="+escape(Cd.referrer)+"&u="+escape(window.location.href)+ "' border='0' wi"+"dth='1' he"+"ight='1'/>"); </script> <script type="application/ld+json"> { "@context": "http://schema.org", "@type": "Person", "name": "Yegor Bugayenko", "url": "https://www.yegor256.com", "sameAs": [ "https://www.facebook.com/yegor256", "https://instagram.com/yegor256", "https://www.linkedin.com/in/yegor256", "https://twitter.com/yegor256", "https://github.com/yegor256", "https://www.pinterest.com/yegor256/" ] } </script> </body> </html>
