<!DOCTYPE html> <html xmlns="http://www.w3.org/1999/xhtml" lang="en-US" xml:lang="en-US" itemscope="" itemtype="http://schema.org/WebSite"> <head> <meta charset="utf-8"/> <meta name="description" content="In object-oriented programming, the more visible and accessible object attributes are, the lower the maintainability of the code around it." /> <meta name="keywords" content="" /> <meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1"/> <meta name="google-site-verification" content="JEj_gQr2CPe2QKGw8XdMz0R7VboQIUbX3FlM-lwTq-8" /> <meta name="author" content="Yegor Bugayenko"> <meta name="og:site_name" content="Yegor Bugayenko"/> <meta name="og:type" content="article" /> <meta name="og:locale" content="en_US" /> <meta name="twitter:account_id" content="4503599630178231" /> <meta name="twitter:creator" content="@yegor256"/> <meta name="twitter:site" content="@yegor256"/> <meta name="twitter:title" property="og:title" content="How Data Visibility Hurts Maintainability"/> <meta name="twitter:description" property="og:description" content="In object-oriented programming, the more visible and accessible object attributes are, the lower the maintainability of the code around it."/> <meta name="twitter:url" property="og:url" content="https://www.yegor256.com/ru/2019/03/12/data-and-maintainability.html"/> <meta name="telegram:channel" content="AAAAAEJFMRzsRTRxM3ec6A"/> <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="yegor256" /> <link rel="shortcut icon" href="/favicon.ico?790d6e310ac"/> <link rel="apple-touch-icon" href="/favicon.ico?790d6e310ac"/> <link rel="alternate" type="application/rss+xml" title="RSS for yegor256.com" href="https://www.yegor256.com/rss.xml"/> <link rel="stylesheet" href="/css/layout.css?790d6e310ac"/> <link rel="stylesheet" href="/css/icons.css?790d6e310ac"/> <link rel="canonical" href="https://www.yegor256.com/ru/2019/03/12/data-and-maintainability.html" /> <title>How Data Visibility Hurts Maintainability</title> </head> <body><div class="wrapper"> <aside class="header-toggle unprintable" id="header-toggle" title="Show the menu" onclick="$('#header').show();$('#header-toggle').hide();">&#9776;</aside> <header class="header" id="header"><div class="face"> <a href="/about-me.html#form" class="sub" title="Click to subscribe to my monthly newsletter"><span>Subscribe</span></a> <a href="/about-me.html" style="position:relative;"> <img src="/images/face-256x256.jpg" class="photo" alt="Yegor Bugayenko"/> </a></div><nav><ul class="menu social notranslate"> <li><a href="https://twitter.com/intent/follow?screen_name=yegor256" rel="nofollow" title="Follow me on Twitter"><i class="icon icon-twitter notranslate" aria-hidden="true"></i></a></li> <li><a href="/rss.xml" rel="nofollow" title="Subscribe to my RSS feed"><i class="icon icon-rss notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://github.com/yegor256" rel="nofollow" title="My GitHub profile"><i class="icon icon-github notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="http://stackoverflow.com/users/187141/yegor256" rel="nofollow" title="My Stack Overflow profile"><i class="icon icon-stackoverflow notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.facebook.com/yegor256" rel="nofollow" title="Follow me on Facebook"><i class="icon icon-facebook notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://instagram.com/yegor256" rel="nofollow" title="Follow me on Instagram"><i class="icon icon-instagram notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.linkedin.com/in/yegor256" rel="nofollow" title="My LinkedIn profile"><i class="icon icon-linkedin notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.youtube.com/c/yegor256?sub_confirmation=1" rel="nofollow" title="My Youtube video channel"><i class="icon icon-youtube notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.pinterest.com/yegor256/" rel="nofollow" title="My Pinterest boards"><i class="icon icon-pinterest notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://angel.co/yegor256" rel="nofollow" title="My AngelList profile"><i class="icon icon-angellist notranslate" aria-hidden="true"></i></a></li> <li><a href="https://soundcloud.com/yegor256" rel="nofollow" title="My podcast"><i class="icon icon-podcast notranslate" aria-hidden="true"></i></a></li> <li><a href="https://itunes.apple.com/us/podcast/yegor256-podcast/id1150826721" rel="nofollow" title="My iTunes podcast"><i class="icon icon-itunes notranslate" aria-hidden="true"></i></a></li> <li><a href="https://t.me/yegor256news" rel="nofollow" title="My Telegram public channel"><i class="icon icon-telegram notranslate" aria-hidden="true"></i></a></li> <li><a href="mailto:blog@yegor256.com" rel="nofollow" title="Email me any time"><i class="icon icon-mail notranslate" aria-hidden="true"></i></a></li></ul><ul class="menu"> <li><a href="/" title="Home page">Home</a></li> <li ><a href="/best.html" title="Best articles to read">12&#160;Best</a></li> <li ><a href="/contents.html" title="The contents of the entire blog">All&#160;387</a></li> <li ><a href="/teaching.html" title="My courses and lectures">Teaching</a></li> <li ><a href="/talks.html" title="Future and past conference talks">Talks</a></li> <li ><a href="/books.html" title="The books I wrote">Books</a></li> <li ><a href="/papers.html" title="My academic papers and patents">Papers</a></li> <li ><a href="/pets.html" title="My loved pet projects">Pets</a></li> <li ><a href="/award.html" title="Software quality award">Award</a></li> <li ><a href="/testimonials.html" title="What some people say about me">Testimonials</a></li> <li ><a href="/shift-m.html" title="Audio podcast about project management">Shift-M</a></li> <li ><a href="/paintings.html" title="My paintings for sale">Art</a></li> <li><a href="https://ru.yegor256.com/" title="Немного на русском языке о политике в России, Украине и мире">Политика</a></li></ul></nav><div class="search"> <form method="get" action="https://www.google.com/search" itemprop="potentialAction" itemscope="" itemtype="http://schema.org/SearchAction"> <meta itemprop="target" content="https://www.google.com/search?q={q}"/> <input name="sitesearch" value="yegor256.com" type="hidden"/> <input itemprop="query-input" type="text" id="search-query" class="field field-text" required="required" onfocus="$('.google').css('visibility', 'visible');" name="q" placeholder="Search..." autocomplete="off"/> <input type="image" src="/images/google-search-icon.svg" class="google" title="Search via Google" alt="Search via Google"/> </form></div><div class="hot"><ul></ul></div></header></div><section itemscope="" itemtype="http://schema.org/BlogPosting"><div class="wrapper"> <header><h1 itemprop="name headline mainEntityOfPage">How Data Visibility Hurts Maintainability</h1></header> <article class="main" itemprop="articleBody" style="font-family: sans-serif; font-size: 0.9em; line-height: 1.2em;"><p style="color: #C42C00;">The following text is a <em>partial</em> translation of the <a href='https://www.yegor256.com/2019/03/12/data-and-maintainability.html'>original English article</a>, performed by <a href="https://chat.openai.com/">ChatGPT</a> (gpt-3.5-turbo) and <a href="https://github.com/yegor256/jekyll-chatgpt-translate">this Jekyll plugin</a>:</p><p>Я так много пишу о объектно-ориентированном программировании и его проблемах, утверждая, что большинство шаблонов проектирования и “хороших практик”, к которым мы привыкли, на самом деле неправильны и вредны, что я совершенно забыл объяснить более общую проблему. Как-то давно кто-то спросил меня в комментариях к блог-посту о “голых” данных: в чём заключается проблема, которую мы решаем, и почему именно поддерживаемость страдает, если недостаточно <em>инкапсулировать</em> наши данные? Вот ответ.</p><p>Я перечитал первые несколько страниц <a href="/elegant-objects.html"><em>Elegant Objects, Volume 1</em></a>, моей книги, полностью посвященной проблемам современного объектно-ориентированного программирования, и обнаружил, что поддерживаемость упоминается непосредственно: “Главная цель, которую я пытаюсь достичь этой работой, - повышение <em>поддерживаемости</em> вашего кода”, а затем также объясняется, что поддерживаемость - это “время, необходимое мне для понимания вашего кода”. Вы <a href="https://softwareengineering.stackexchange.com/questions/141005">можете поспорить на этот счет</a>, но вопрос остается: как отсутствие “истинной” объектно-ориентированности и правильной инкапсуляции влияет на читаемость?</p><p>Я не знаю точного ответа, но вот моя собственная версия, основанная на моих годах кодирования и страдания: <em>более узкий объем</em> является ключевым фактором успеха лучшей поддерживаемости, а отсутствие инкапсуляции приводит к большему объему. Вы знаете, что такое <a href="https://en.wikipedia.org/wiki/Scope_%28computer_science%29">область видимости</a>, верно? Давайте возьмем этот пример кода на языке C:</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>void print() {
  for (int i = 0; i &lt; 10; ++i) {
    printf("%d * 2 = %d", i, i * 2);
  }
  for (int i = 0; i &lt; 10; ++i) {
    printf("%d * 3 = %d", i, i * 3);
  }
}
</code></pre></div></div><p>Есть две переменные <code class="language-plaintext highlighter-rouge">i</code>, видимые в двух разных циклах <code class="language-plaintext highlighter-rouge">for</code>, двух разных областях видимости. <em>Размер</em> каждой области составляет три строки кода. Как насчет этого кода, выполняющего точно то же самое:</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>void print() {
  int i = 0;
  while (++i &lt; 10) {
    printf("%d * 2 = %d", i, i * 2);
  }
  i -= 10;
  while (++i &lt; 10) {
    printf("%d * 3 = %d", i, i * 3);
  }
}
</code></pre></div></div><p>Теперь область видимости переменной <code class="language-plaintext highlighter-rouge">i</code> составляет десять строк кода. Код работает так же хорошо, как и в первом отрывке, но его поддерживаемость ниже, так как для понимания происходящего и внесения изменений мне требуется больше времени. Мне нужно читать блок кода из десяти строк, а не из двух блоков по три строки. Мне нужно разобраться с полным методом <code class="language-plaintext highlighter-rouge">print()</code> прежде, чем я смогу начать вносить любые изменения. Мне нужно понять алгоритм жизненного цикла этой бедной переменной <code class="language-plaintext highlighter-rouge">i</code> и почему, например, она уменьшается на 10, а не присваивается нулю - это сюрприз, который оставили мне предыдущие программисты. Может быть, они не знали о существовании циклов <code class="language-plaintext highlighter-rouge">for</code>?</p><p>Очевидно, что первый фрагмент лучше второго. Вопрос в том, как заставить программистов писать код так, как написан первый фрагмент, и сделать область видимости каждой переменной и функции меньше? Мы можем обучать их, писать для них книги, убеждать их, тренировать их, или даже наказывать за использование большой области видимости и менее читаемого кода, но если сам язык программирования не предотвращает появление этих больших областей видимости, никакая помощь не будет действительно эффективной. Лучше изобрести язык программирования или целую парадигму программирования, чтобы усложнить или невозможным сделать увеличение области видимости.</p><p>Например, самый широкий объем, который можно представить в C/C++, Python, Ruby и многих других современных языках, - это глобальный, например, здесь:</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>int i = 0;
void print() {
  while (++i &lt; 10) {
    printf("%d * 2 = %d", i, i * 2);
  }
}
</code></pre></div></div><p>Теперь переменная <code class="language-plaintext highlighter-rouge">i</code> видна не только внутри функции <code class="language-plaintext highlighter-rouge">print()</code>, но и во <del>многих</del> всех других местах нашего разрабатываемого приложения. Область видимости переменной <code class="language-plaintext highlighter-rouge">i</code> охватывает весь код. Следует отметить, что это делает код функции <code class="language-plaintext highlighter-rouge">print()</code> очень трудночитаемым. Я просто не могу знать, какое значение ожидать в переменной <code class="language-plaintext highlighter-rouge">i</code>, когда начинается выполнение <code class="language-plaintext highlighter-rouge">print()</code>, и мне приходится просматривать весь код, чтобы узнать это. Если это небольшое приложение, возможно, я справлюсь, но если речь идет о большом программном обеспечении, у меня возникнут большие проблемы. Итак, что насчет создания языка программирования, который не позволяет использовать глобальные переменные? Это решит проблему. Программисты не смогут определить их технически, и области их видимости будут неизбежно меньше.</p><p>Я считаю, что объекты были изобретены именно для этого: чтобы <em>побудить</em> программистов делать области видимости меньше. Ну, на самом деле, функции и подпрограммы тоже были изобретены для этого, но с меньшим акцентом на “побуждение”, так как они могли сосуществовать с кодом, который еще не был разложен на части. Напротив, объекты должны были быть объектами первого класса в объектном мире, взаимодействуя только с объектами.</p><p>They were.</p><p>Но потом появился C++ и всё испортил.</p><p>Давайте попробуем внести объект в наш фрагмент кода на языке C, так, как это делают некоторые программисты на C++.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>class Idx {
public:
  int get() { return v; }
  void add(int a) { v += a; }
private:
  int v = 0;
}
</code></pre></div></div><p>And then:</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>void print() {
  Idx i();
  while (i.get() &lt; 10) {
    printf("%d * 2 = %d", i.get(), i.get() * 2);
    i.add(1);
  }
  i.add(-10);
  while (i.get() &lt; 10) {
    printf("%d * 3 = %d", i.get(), i.get() * 3);
    i.add(1);
  }
}
</code></pre></div></div><p>Что изменилось? Не так уж и много. Вместо обычной “скалярной” переменной <code class="language-plaintext highlighter-rouge">i</code> у нас есть “объект”, который хранит внутри себя целочисленное значение и предоставляет несколько методов для доступа и изменения его значения. Помогло ли это нам уменьшить область видимости? Совсем нет. Более того, длина <code class="language-plaintext highlighter-rouge">print()</code> теперь даже на несколько строк больше. Но теперь у нас есть объект и мы можем назвать наш код объектно-ориентированным!</p><p>В настоящее время большинство “объектов” используются именно так, в основном благодаря C++: они просто хранят данные, а их реальные пользователи находятся за их пределами. Объект <code class="language-plaintext highlighter-rouge">Idx</code> ничего не знает о реальной цели хранимых им данных. Он не знает, что его <code class="language-plaintext highlighter-rouge">v</code> используется в качестве счетчика шагов и что оно умножается на что-то перед выводом некоторого текста. <code class="language-plaintext highlighter-rouge">Idx</code> - это хранилище данных, а реальная логика находится вне его.</p><p>Проблема поддерживаемости не решена, объем не уменьшен, сложность кода не снижена. Более того, она увеличена, потому что теперь, чтобы понять, как работает <code class="language-plaintext highlighter-rouge">print()</code>, мне нужно знать, что находится внутри <code class="language-plaintext highlighter-rouge">Idx</code>. Объектная парадигма в этом конкретном примере обещала взять на себя часть проблемы и больше не беспокоить меня, но на самом деле она только увеличила проблему, вернув мне две проблемы: <code class="language-plaintext highlighter-rouge">print()</code> и <code class="language-plaintext highlighter-rouge">Idx</code>.</p><p>Почему это благодаря C++? Потому что C++ добавил объектно-ориентированность поверх процедурного программирования на C, не думая даже о запрете некоторых из них, чтобы <em>принудить</em> программистов писать объекты так, как они должны быть написаны: как черные ящики, которые инкапсулируют все, что им нужно, и не позволяют никому снаружи даже <em>знать</em>, что находится внутри! C++ даже не попытался переключить парадигму от процедур и переменных к объектам и методам. <a href="https://en.wikipedia.org/wiki/Bjarne_Stroustrup">Бьярне Страуструп</a>, создатель C++, просто дал программистам методы и классы и сказал: “Используйте их, они удобнее переменных, … или, может быть, иногда нет, … Я не знаю” (я не уверен, что это его цитата, но я считаю, что это очень близко к тому, что он имел в виду). Прочтите <a href="http://amzn.to/2uMlANB">его книгу</a>, и вы увидите, сколько страниц посвящено философии объектно-ориентированного программирования и сколько - техническим аспектам операторов и инструкций.</p><p>Правильное объектно-ориентированное решение будет выглядеть иначе и будет включать настоящую инкапсуляцию, где данные никогда не “выходят за пределы” своего владельца. Во-первых, вот как я бы разработал <code class="language-plaintext highlighter-rouge">Idx</code>… ну, сначала я бы переименовал его и назвал бы <code class="language-plaintext highlighter-rouge">Line</code>:</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>class Line {
public:
  Line(int m): mul(m) {};
  void print() {
    printf("%d * %d = %d", v, m, v * m);
  }
  bool next() {
    bool n = true;
    if (v &lt; 10) {
      ++v;
    } else {
      n = false;
    }
    return n;
  }
private:
  int mul;
  int v = 0;
}
</code></pre></div></div><p>И вот здесь находится код <code class="language-plaintext highlighter-rouge">print()</code>:</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>void print() {
  Line a(2);
  while (a.next()) { a.print(); }
  Line b(3);
  while (b.next()) { b.print(); }
}
</code></pre></div></div><p>Как вы видите, <code class="language-plaintext highlighter-rouge">print()</code> не имеет доступа к внутренним данным <code class="language-plaintext highlighter-rouge">Line</code>. Все, что может сделать <code class="language-plaintext highlighter-rouge">print()</code>, это попросить <code class="language-plaintext highlighter-rouge">Line</code> переместиться вперед и напечатать самого себя. Как именно эта логика реализована внутри <code class="language-plaintext highlighter-rouge">Line</code> - никто не знает и никто не хочет знать. Поскольку у нас нет геттеров в <code class="language-plaintext highlighter-rouge">Line</code>, мы не можем извлечь данные из него.</p><p>Поскольку мы не можем извлечь данные, мы не можем построить никакую логику в <code class="language-plaintext highlighter-rouge">print()</code>. У нас просто нет ничего, с чем можно работать, ни данных, ни целых чисел, ни чисел. Мы можем работать только с объектами, которые не доверяют нам своим внутренностям. Мы можем только <em>вежливо</em> попросить их что-то сделать для нас. Область видимости <code class="language-plaintext highlighter-rouge">print()</code> теперь довольно мала и очень хорошо <em>изолирована</em> от внутренних частей <code class="language-plaintext highlighter-rouge">Line</code>. Правильная инкапсуляция помогла нам добиться этого: не раскрывая внутренние части <code class="language-plaintext highlighter-rouge">Line</code>, мы сделали невозможным для кого-либо войти в ее собственную область видимости. <code class="language-plaintext highlighter-rouge">print()</code> просто не может делать ничего с данными, инкапсулированными в <code class="language-plaintext highlighter-rouge">Line</code>.</p><p>Таким образом, чем более видимыми и доступными являются данные, тем ниже обеспечивается их поддержка.</p><p>Сама идея объектно-ориентированного программирования основывается на инкапсуляции, которая не только ограничивает возможность изменения атрибутов объекта извне, но и запрещает читать эти атрибуты каждому.</p><blockquote class="twitter-tweet" data-lang="en"><p lang="en" dir="ltr">What is wrong with this Java object? <a href="https://twitter.com/hashtag/elegantobjects?src=hash&amp;ref_src=twsrc%5Etfw">#elegantobjects</a> <a href="https://twitter.com/hashtag/java?src=hash&amp;ref_src=twsrc%5Etfw">#java</a><br /><br />final class Time {<br /> int getHours();<br /> int getMinutes();<br /> int getSeconds();<br />}</p>&mdash; Yegor Bugayenko (@yegor256) <a href="https://twitter.com/yegor256/status/1109750701285142533?ref_src=twsrc%5Etfw">March 24, 2019</a></blockquote> <script async="" src="https://platform.twitter.com/widgets.js" charset="utf-8"></script><p class="jekyll-chatgpt-translate">Translated by ChatGPT gpt-3.5-turbo/35 on 2023-09-06 at 20:02</p></article></div><div class="wrapper"> <footer class="footer"><p> &copy; <span itemscope="" itemprop="copyrightHolder" itemtype="http://schema.org/Person"> <span itemprop="name">Yegor Bugayenko</span> </span> 2014&ndash;<span itemprop="copyrightYear">2023</span></p></footer></div></section><div class="wrapper unprintable" style="text-align:center;margin-top:2em;"> <a href="https://www.sixnines.io/h/3ba1652f"> <img src="//www.sixnines.io/b/3ba1652f?style=flat" alt="sixnines availability badge" /></a> &nbsp; <a href="https://github.com/yegor256/blog/stargazers"> <img src="//img.shields.io/github/stars/yegor256/blog.svg?style=flat-square" alt="GitHub stars" /></a></div><script src="//code.jquery.com/jquery-1.9.0.min.js"></script> <script src="/js/all.js?790d6e310ac"></script> <script>var disqus_shortname = 'yegor256';</script> <script id="dsq-count-scr" src="//yegor256.disqus.com/count.js" async="async"></script> <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','//www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-1963507-32', 'auto'); ga('send', 'pageview'); </script> <script> Cd=document;Cr="&"+Math.random();Cp="&s=1"; Cd.cookie="b=b";if(Cd.cookie)Cp+="&c=1"; Cp+="&t="+(new Date()).getTimezoneOffset(); if(self!=top)Cp+="&f=1"; </script> <script> if(navigator.javaEnabled())Cp+="&j=1"; </script> <script> if(typeof(screen)!='undefined')Cp+="&w="+screen.width+"&h="+ screen.height+"&d="+(screen.colorDepth?screen.colorDepth:screen.pixelDepth); </script> <script> Cd.write("<img src='//c.hit.ua/hit?i=95870&g=0&x=2"+Cp+Cr+ "&r="+escape(Cd.referrer)+"&u="+escape(window.location.href)+ "' border='0' wi"+"dth='1' he"+"ight='1'/>"); </script> <script type="application/ld+json"> { "@context": "http://schema.org", "@type": "Person", "name": "Yegor Bugayenko", "url": "https://www.yegor256.com", "sameAs": [ "https://www.facebook.com/yegor256", "https://instagram.com/yegor256", "https://www.linkedin.com/in/yegor256", "https://twitter.com/yegor256", "https://github.com/yegor256", "https://www.pinterest.com/yegor256/" ] } </script> </body> </html>
