<!DOCTYPE html> <html xmlns="http://www.w3.org/1999/xhtml" lang="en-US" xml:lang="en-US" itemscope="" itemtype="http://schema.org/WebSite"> <head> <meta charset="utf-8"/> <meta name="description" content="While most programmers think checked exceptions in Java are a mistake, I'm of the opposite opinion---unchecked ones are a mistake." /> <meta name="keywords" content="" /> <meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1"/> <meta name="google-site-verification" content="JEj_gQr2CPe2QKGw8XdMz0R7VboQIUbX3FlM-lwTq-8" /> <meta name="author" content="Yegor Bugayenko"> <meta name="og:site_name" content="Yegor Bugayenko"/> <meta name="og:type" content="article" /> <meta name="og:locale" content="en_US" /> <meta name="twitter:account_id" content="4503599630178231" /> <meta name="twitter:creator" content="@yegor256"/> <meta name="twitter:site" content="@yegor256"/> <meta name="twitter:title" property="og:title" content="Checked vs. Unchecked Exceptions: The Debate Is Not Over"/> <meta name="twitter:description" property="og:description" content="While most programmers think checked exceptions in Java are a mistake, I'm of the opposite opinion---unchecked ones are a mistake."/> <meta name="twitter:url" property="og:url" content="https://www.yegor256.com/ru/2015/07/28/checked-vs-unchecked-exceptions.html"/> <meta name="telegram:channel" content="AAAAAEJFMRzsRTRxM3ec6A"/> <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="yegor256" /> <link rel="shortcut icon" href="/favicon.ico?3d882d517f5"/> <link rel="apple-touch-icon" href="/favicon.ico?3d882d517f5"/> <link rel="alternate" type="application/rss+xml" title="RSS for yegor256.com" href="https://www.yegor256.com/rss.xml"/> <link rel="stylesheet" href="/css/layout.css?3d882d517f5"/> <link rel="stylesheet" href="/css/icons.css?3d882d517f5"/> <link rel="canonical" href="https://www.yegor256.com/ru/2015/07/28/checked-vs-unchecked-exceptions.html" /> <title>Checked vs. Unchecked Exceptions: The Debate Is Not Over</title> </head> <body><div class="wrapper"> <aside class="header-toggle unprintable" id="header-toggle" title="Show the menu" onclick="$('#header').show();$('#header-toggle').hide();">&#9776;</aside> <header class="header" id="header"><div class="face"> <a href="/about-me.html#form" class="sub" title="Click to subscribe to my monthly newsletter"><span>Subscribe</span></a> <a href="/about-me.html" style="position:relative;"> <img src="/images/face-256x256.jpg" class="photo" alt="Yegor Bugayenko"/> </a></div><nav><ul class="menu social notranslate"> <li><a href="https://twitter.com/intent/follow?screen_name=yegor256" rel="nofollow" title="Follow me on Twitter"><i class="icon icon-twitter notranslate" aria-hidden="true"></i></a></li> <li><a href="/rss.xml" rel="nofollow" title="Subscribe to my RSS feed"><i class="icon icon-rss notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://github.com/yegor256" rel="nofollow" title="My GitHub profile"><i class="icon icon-github notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="http://stackoverflow.com/users/187141/yegor256" rel="nofollow" title="My Stack Overflow profile"><i class="icon icon-stackoverflow notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.facebook.com/yegor256" rel="nofollow" title="Follow me on Facebook"><i class="icon icon-facebook notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://instagram.com/yegor256" rel="nofollow" title="Follow me on Instagram"><i class="icon icon-instagram notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.linkedin.com/in/yegor256" rel="nofollow" title="My LinkedIn profile"><i class="icon icon-linkedin notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.youtube.com/c/yegor256?sub_confirmation=1" rel="nofollow" title="My Youtube video channel"><i class="icon icon-youtube notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.pinterest.com/yegor256/" rel="nofollow" title="My Pinterest boards"><i class="icon icon-pinterest notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://angel.co/yegor256" rel="nofollow" title="My AngelList profile"><i class="icon icon-angellist notranslate" aria-hidden="true"></i></a></li> <li><a href="https://soundcloud.com/yegor256" rel="nofollow" title="My podcast"><i class="icon icon-podcast notranslate" aria-hidden="true"></i></a></li> <li><a href="https://itunes.apple.com/us/podcast/yegor256-podcast/id1150826721" rel="nofollow" title="My iTunes podcast"><i class="icon icon-itunes notranslate" aria-hidden="true"></i></a></li> <li><a href="https://t.me/yegor256news" rel="nofollow" title="My Telegram public channel"><i class="icon icon-telegram notranslate" aria-hidden="true"></i></a></li> <li><a href="mailto:blog@yegor256.com" rel="nofollow" title="Email me any time"><i class="icon icon-mail notranslate" aria-hidden="true"></i></a></li></ul><ul class="menu"> <li><a href="/" title="Home page">Home</a></li> <li ><a href="/best.html" title="Best articles to read">12&#160;Best</a></li> <li ><a href="/contents.html" title="The contents of the entire blog">All&#160;385</a></li> <li ><a href="/teaching.html" title="My courses and lectures">Teaching</a></li> <li ><a href="/talks.html" title="Future and past conference talks">Talks</a></li> <li ><a href="/books.html" title="The books I wrote">Books</a></li> <li ><a href="/papers.html" title="My academic papers and patents">Papers</a></li> <li ><a href="/pets.html" title="My loved pet projects">Pets</a></li> <li ><a href="/award.html" title="Software quality award">Award</a></li> <li ><a href="/testimonials.html" title="What some people say about me">Testimonials</a></li> <li ><a href="/shift-m.html" title="Audio podcast about project management">Shift-M</a></li> <li ><a href="/paintings.html" title="My paintings for sale">Art</a></li> <li><a href="https://ru.yegor256.com/" title="Немного на русском языке о политике в России, Украине и мире">Политика</a></li></ul></nav><div class="search"> <form method="get" action="https://www.google.com/search" itemprop="potentialAction" itemscope="" itemtype="http://schema.org/SearchAction"> <meta itemprop="target" content="https://www.google.com/search?q={q}"/> <input name="sitesearch" value="yegor256.com" type="hidden"/> <input itemprop="query-input" type="text" id="search-query" class="field field-text" required="required" onfocus="$('.google').css('visibility', 'visible');" name="q" placeholder="Search..." autocomplete="off"/> <input type="image" src="/images/google-search-icon.svg" class="google" title="Search via Google" alt="Search via Google"/> </form></div><div class="hot"><ul></ul></div></header></div><section itemscope="" itemtype="http://schema.org/BlogPosting"><div class="wrapper"> <header><h1 itemprop="name headline mainEntityOfPage">Checked vs. Unchecked Exceptions: The Debate Is Not Over</h1></header> <article class="main" itemprop="articleBody" style="font-family: sans-serif; font-size: 0.9em; line-height: 1.2em;"><p style="color: #C42C00;">The following text is a <em>partial</em> translation of the <a href='https://www.yegor256.com/2015/07/28/checked-vs-unchecked-exceptions.html'>original English article</a>, performed by <a href="https://chat.openai.com/">ChatGPT</a> (gpt-3.5-turbo) and <a href="https://github.com/yegor256/jekyll-chatgpt-translate">this Jekyll plugin</a>:</p><p>Нужны ли нам вообще проверяемые исключения? Спор окончен, не так ли? Не для меня. В то время как у большинства объектно-ориентированных языков их нет, и большинство программистов считает проверяемые исключения ошибкой в Java, я верю в обратное - непроверяемые исключения - это <strong>ошибка</strong>. Более того, я считаю, что также плохая идея - это множество типов исключений.</p><p>Давайте сначала я поясню, как я понимаю исключения в объектно-ориентированном программировании. Затем я сравню свое понимание с «традиционным» подходом, и мы обсудим различия. Итак, сначала мое понимание.</p><p>Предположим, есть метод, который сохраняет некоторые двоичные данные в файл:</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>public void save(File file, byte[] data)
  throws Exception {
  // save data to the file
}
</code></pre></div></div><p>Когда все идет хорошо, метод просто сохраняет данные и возвращает управление. Когда что-то идет не так, он выбрасывает исключение <code class="language-plaintext highlighter-rouge">Exception</code>, и нам нужно что-то с этим сделать:</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>try {
  save(file, data);
} catch (Exception ex) {
  System.out.println("Sorry, we can't save right now.");
}
</code></pre></div></div><p>Когда метод указывает, что он “выбрасывает” исключение, я понимаю, что этот метод не является <strong>безопасным</strong>. Он может иногда завершиться с ошибкой, и моя ответственность либо 1) обработать эту ошибку, либо 2) также объявить себя <strong>небезопасным</strong>.</p><p>Я знаю, что каждый метод создан с учетом принципа <a href="https://en.wikipedia.org/wiki/Single_responsibility_principle">единственности ответственности</a>. Это гарантирует мне, что если метод <code class="language-plaintext highlighter-rouge">save()</code> завершается с ошибкой, это означает, что операция сохранения не может быть завершена. Если мне нужно узнать, что стало причиной этой ошибки, я буду <a href="https://en.wikipedia.org/wiki/Exception_chaining">прерывать цепочку</a> исключений - просматривать стек связанных исключений и стеки вызовов, инкапсулированные в <code class="language-plaintext highlighter-rouge">ex</code>.</p><p>Я никогда не использую исключения для управления потоком выполнения, что означает, что я <strong>никогда не восстанавливаю</strong> ситуации, в которых возникают исключения. Когда возникает исключение, я позволяю ему подняться до самого верхнего уровня приложения. Иногда я <a href="">повторно выбрасываю</a> его, чтобы добавить больше семантической информации к цепочке. Поэтому для меня не имеет значения, какая была причина исключения, вызванного <code class="language-plaintext highlighter-rouge">save()</code>. Я просто знаю, что метод не удалось выполнить. Мне этого достаточно. Всегда.</p><p>По той же причине мне не нужно различать различные типы исключений. Мне просто не нужна такая иерархия. <code class="language-plaintext highlighter-rouge">Exception</code> мне достаточно. Опять же, это потому, что я не использую исключения для управления потоком выполнения.</p><p>Вот так я понимаю исключения.</p><p>Согласно этой парадигме, я бы сказал, что мы должны:</p><ul> <li><p>Всегда используйте проверяемые исключения.</p></li> <li><p>Никогда не выбрасывайте/используйте непроверяемые исключения.</p></li> <li><p>Используйте только <code class="language-plaintext highlighter-rouge">Исключение</code>, без каких-либо подтипов.</p></li> <li><p>Всегда объявляйте один тип исключения в блоке <code class="language-plaintext highlighter-rouge">throws</code>.</p></li> <li><p>Никогда не ловите без повторной генерации; прочитайте <a href="">подробнее об этом здесь</a>.</p></li></ul><p>Эта парадигма отличается от многих других статей, которые я нашел на эту тему. Давайте сравним и обсудим.</p><h2 id="runtime-vs-api-exceptions">Runtime vs. API Exceptions</h2><p><a href="http://docs.oracle.com/javase/tutorial/essential/exceptions/runtime.html">Oracle говорит</a>, что некоторые исключения должны быть частью API (проверяемые), в то время как некоторые являются исключениями времени выполнения и не должны быть частью API (непроверяемые). Они будут задокументированы в JavaDoc, но не в сигнатуре метода.</p><p>Я не понимаю логики здесь, и уверен, что дизайнеры Java тоже ее не понимают. Как и почему некоторые исключения важны, а другие нет? Почему некоторые из них заслуживают правильное положение в API в блоке <code class="language-plaintext highlighter-rouge">throws</code> сигнатуры метода, а другие нет? Каковы критерии?</p><p>У меня здесь есть ответ. Введение проверяемых и непроверяемых исключений разработчиками Java было попыткой решить проблему методов, которые слишком сложные и беспорядочные. Когда метод слишком большой и делает слишком много вещей одновременно (нарушает принцип единственной ответственности), определенно лучше держать некоторые исключения “скрытыми” (так называемые непроверяемые). Но это не настоящее решение. Это только временное исправление, которое причиняет нам больше вреда, чем пользы - методы продолжают расти по размеру и сложности.</p><p>Непроверяемые исключения - это ошибка в дизайне Java, а не проверяемые.</p><p>Скрытие того факта, что метод может в конечном счете завершиться неудачей, является ошибкой. Именно это делают непроверяемые исключения.</p><p>Вместо этого, мы должны сделать этот факт видимым. Когда метод выполняет слишком много действий, возникает слишком много точек отказа, и автор метода понимает, что что-то не так - метод не должен вызывать исключения в таком большом количестве ситуаций. Это приведет к рефакторингу. Наличие непроверяемых исключений приводит к беспорядку. Кстати, в Ruby, C#, Python, PHP и т. д. вообще нет проверяемых исключений. Это означает, что создатели этих языков еще меньше понимают ООП, чем авторы Java.</p><h2 id="checked-exceptions-are-too-noisy">Checked Exceptions Are Too Noisy</h2><p>Еще одним распространенным аргументом против проверяемых исключений является то, что они делают наш код более громоздким. Мы должны размещать <code class="language-plaintext highlighter-rouge">try/catch</code> повсюду вместо того, чтобы фокусироваться на основной логике. Божидар Божанов даже <a href="http://techblog.bozho.net/checked-and-unchecked-exceptions-in-java/">предлагает</a> техническое решение для этой проблемы громоздкости.</p><p>Опять же, я не понимаю эту логику. Если я хочу что-то сделать, когда метод <code class="language-plaintext highlighter-rouge">save()</code> завершается неудачно, я ловлю исключение и как-то обрабатываю ситуацию. Если мне не хочется делать этого, я просто объявляю, что мой метод также <code class="language-plaintext highlighter-rouge">throws</code> и не обращаю внимания на обработку исключений. В чем проблема? Откуда появляется излишняя детализация?</p><p>У меня здесь тоже есть ответ. Он основан на наличии непроверяемых исключений. Мы просто не всегда можем игнорировать отказ, потому что интерфейсы, которые мы используем, не позволяют нам это сделать. Вот и всё. Например, класс <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Runnable.html"><code class="language-plaintext highlighter-rouge">Runnable</code></a>, который широко используется для многопоточного программирования, имеет метод <code class="language-plaintext highlighter-rouge">run()</code>, который не должен выбрасывать никаких исключений. Поэтому мы всегда должны перехватывать все исключения внутри метода и повторно выбрасывать проверяемые исключения как непроверяемые.</p><p>Если все методы во всех Java <a href="">интерфейсах</a> были бы объявлены либо как “безопасные” (<code class="language-plaintext highlighter-rouge">throws</code> ничего), либо как “небезопасные” (<code class="language-plaintext highlighter-rouge">throws Exception</code>), все стало бы логичным и понятным. Если вы хотите оставаться “безопасными”, возьмите на себя ответственность за обработку ошибок. В противном случае, будьте “небезопасными” и позвольте вашим пользователям заботиться о безопасности.</p><p>Никакого шума, очень чистый код и очевидная логика.</p><h2 id="inappropriately-exposed-implementation-details">Inappropriately Exposed Implementation Details</h2><p><a href="http://www.ibm.com/developerworks/library/j-jtp05254/">Некоторые говорят</a>, что возможность поместить проверяемое исключение в <code class="language-plaintext highlighter-rouge">throws</code> в сигнатуре метода вместо его перехвата и повторного выброса нового типа побуждает нас иметь слишком много несущественных типов исключений в сигнатурах методов. Например, наш метод <code class="language-plaintext highlighter-rouge">save()</code> может объявить, что он может выбросить исключение <code class="language-plaintext highlighter-rouge">OutOfMemoryException</code>, даже если это, кажется, не имеет никакого отношения к выделению памяти. Но ведь он все же выделяет какую-то память, верно? Поэтому такое переполнение памяти может произойти во время операции сохранения файла.</p><p>Опять же, я не понимаю логику этого аргумента. Если все исключения проверяются, и у нас нет нескольких типов исключений, мы просто выбрасываем <code class="language-plaintext highlighter-rouge">Exception</code> везде, и все. Зачем нам вообще заботиться о типе исключения? Если мы не используем исключения для управления потоком исполнения, мы не будем делать этого.</p><p>Если мы действительно хотим сделать наше приложение устойчивым к переполнению памяти, мы введем некоторый менеджер памяти, который будет иметь что-то вроде метода <code class="language-plaintext highlighter-rouge">bigEnough()</code>, который сообщит нам, достаточно ли нашей кучи для следующей операции. Использование исключений в таких ситуациях является полностью неуместным подходом к управлению исключениями в ООП.</p><h2 id="recoverable-exceptions">Recoverable Exceptions</h2><p>Джошуа Блох, в <a href="http://amzn.to/2crH5tW"><em>Effective Java</em></a>, говорит, что следует “использовать проверяемые исключения для восстанавливаемых условий и исключения времени выполнения для программных ошибок.” Он имеет в виду нечто подобное:</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>try {
  save(file, data);
} catch (Exception ex) {
  // We can't save the file, but it's OK
  // Let's move on and do something else
}
</code></pre></div></div><p>В чем тут разница с известным анти-паттерном под названием <a href="http://c2.com/cgi/wiki?DontUseExceptionsForFlowControl">Don’t Use Exceptions for Flow Control</a>? Джошуа, с уважением, ты не прав. В объектно-ориентированном программировании нет такого понятия как восстанавливаемые условия. Исключение указывает на то, что выполнение цепочки вызовов от метода к методу было прервано и пришло время подняться по цепочке и остановиться где-то. Но после исключения мы уже не возвращаемся обратно:</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>App#run()
  Data#update()
    Data#write()
      File#save() &lt;-- Boom, there's a failure here, so we go up
</code></pre></div></div><p>Мы можем начать эту цепочку заново, но мы не возвращаемся после <code class="language-plaintext highlighter-rouge">throw</code>. Другими словами, мы не <strong>выполняем</strong> никаких действий в блоке <code class="language-plaintext highlighter-rouge">catch</code>. Мы только сообщаем о проблеме и завершаем выполнение. Мы никогда не “восстанавливаемся”!</p><hr /><p>All arguments against checked exceptions demonstrate nothing but a serious misunderstanding of object-oriented programming by their authors. The mistake in Java and in many other languages is the existence of unchecked exceptions, not checked ones.</p><p class="jekyll-chatgpt-translate">Translated by ChatGPT gpt-3.5-turbo/30 on 2023-08-29 at 06:14</p></article></div><div class="wrapper"> <footer class="footer"><p> &copy; <span itemscope="" itemprop="copyrightHolder" itemtype="http://schema.org/Person"> <span itemprop="name">Yegor Bugayenko</span> </span> 2014&ndash;<span itemprop="copyrightYear">2023</span></p></footer></div></section><div class="wrapper unprintable" style="text-align:center;margin-top:2em;"> <a href="https://www.sixnines.io/h/3ba1652f"> <img src="//www.sixnines.io/b/3ba1652f?style=flat" alt="sixnines availability badge" /></a> &nbsp; <a href="https://github.com/yegor256/blog/stargazers"> <img src="//img.shields.io/github/stars/yegor256/blog.svg?style=flat-square" alt="GitHub stars" /></a></div><script src="//code.jquery.com/jquery-1.9.0.min.js"></script> <script src="/js/all.js?3d882d517f5"></script> <script>var disqus_shortname = 'yegor256';</script> <script id="dsq-count-scr" src="//yegor256.disqus.com/count.js" async="async"></script> <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','//www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-1963507-32', 'auto'); ga('send', 'pageview'); </script> <script> Cd=document;Cr="&"+Math.random();Cp="&s=1"; Cd.cookie="b=b";if(Cd.cookie)Cp+="&c=1"; Cp+="&t="+(new Date()).getTimezoneOffset(); if(self!=top)Cp+="&f=1"; </script> <script> if(navigator.javaEnabled())Cp+="&j=1"; </script> <script> if(typeof(screen)!='undefined')Cp+="&w="+screen.width+"&h="+ screen.height+"&d="+(screen.colorDepth?screen.colorDepth:screen.pixelDepth); </script> <script> Cd.write("<img src='//c.hit.ua/hit?i=95870&g=0&x=2"+Cp+Cr+ "&r="+escape(Cd.referrer)+"&u="+escape(window.location.href)+ "' border='0' wi"+"dth='1' he"+"ight='1'/>"); </script> <script type="application/ld+json"> { "@context": "http://schema.org", "@type": "Person", "name": "Yegor Bugayenko", "url": "https://www.yegor256.com", "sameAs": [ "https://www.facebook.com/yegor256", "https://instagram.com/yegor256", "https://www.linkedin.com/in/yegor256", "https://twitter.com/yegor256", "https://github.com/yegor256", "https://www.pinterest.com/yegor256/" ] } </script> </body> </html>
