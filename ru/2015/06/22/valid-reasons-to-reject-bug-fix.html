<!DOCTYPE html> <html xmlns="http://www.w3.org/1999/xhtml" lang="en-US" xml:lang="en-US" itemscope="" itemtype="http://schema.org/WebSite"> <head> <meta charset="utf-8"/> <meta name="description" content="A bug fix is supposed to improve the quality of the software, but very often the effect of it is actually negative; here is why and how to avoid that." /> <meta name="keywords" content="" /> <meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1"/> <meta name="google-site-verification" content="JEj_gQr2CPe2QKGw8XdMz0R7VboQIUbX3FlM-lwTq-8" /> <meta name="author" content="Yegor Bugayenko"> <meta name="og:site_name" content="Yegor Bugayenko"/> <meta name="og:type" content="article" /> <meta name="og:locale" content="en_US" /> <meta name="twitter:account_id" content="4503599630178231" /> <meta name="twitter:creator" content="@yegor256"/> <meta name="twitter:site" content="@yegor256"/> <meta name="twitter:title" property="og:title" content="A Few Valid Reasons to Reject a Bug Fix"/> <meta name="twitter:description" property="og:description" content="A bug fix is supposed to improve the quality of the software, but very often the effect of it is actually negative; here is why and how to avoid that."/> <meta name="twitter:url" property="og:url" content="https://www.yegor256.com/ru/2015/06/22/valid-reasons-to-reject-bug-fix.html"/> <meta name="telegram:channel" content="AAAAAEJFMRzsRTRxM3ec6A"/> <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="yegor256" /> <link rel="shortcut icon" href="/favicon.ico?18ddfcd095e"/> <link rel="apple-touch-icon" href="/favicon.ico?18ddfcd095e"/> <link rel="alternate" type="application/rss+xml" title="RSS for yegor256.com" href="https://www.yegor256.com/rss.xml"/> <link rel="stylesheet" href="/css/layout.css?18ddfcd095e"/> <link rel="stylesheet" href="/css/icons.css?18ddfcd095e"/> <link rel="canonical" href="https://www.yegor256.com/ru/2015/06/22/valid-reasons-to-reject-bug-fix.html" /> <title>A Few Valid Reasons to Reject a Bug Fix</title> </head> <body><div class="wrapper"> <aside class="header-toggle unprintable" id="header-toggle" title="Show the menu" onclick="$('#header').show();$('#header-toggle').hide();">&#9776;</aside> <header class="header" id="header"><div class="face"> <a href="/about-me.html#form" class="sub" title="Click to subscribe to my monthly newsletter"><span>Subscribe</span></a> <a href="/about-me.html" style="position:relative;"> <img src="/images/face-256x256.jpg" class="photo" alt="Yegor Bugayenko"/> </a></div><nav><ul class="menu social notranslate"> <li><a href="https://twitter.com/intent/follow?screen_name=yegor256" rel="nofollow" title="Follow me on Twitter"><i class="icon icon-twitter notranslate" aria-hidden="true"></i></a></li> <li><a href="/rss.xml" rel="nofollow" title="Subscribe to my RSS feed"><i class="icon icon-rss notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://github.com/yegor256" rel="nofollow" title="My GitHub profile"><i class="icon icon-github notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="http://stackoverflow.com/users/187141/yegor256" rel="nofollow" title="My Stack Overflow profile"><i class="icon icon-stackoverflow notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.facebook.com/yegor256" rel="nofollow" title="Follow me on Facebook"><i class="icon icon-facebook notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://instagram.com/yegor256" rel="nofollow" title="Follow me on Instagram"><i class="icon icon-instagram notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.linkedin.com/in/yegor256" rel="nofollow" title="My LinkedIn profile"><i class="icon icon-linkedin notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.youtube.com/c/yegor256?sub_confirmation=1" rel="nofollow" title="My Youtube video channel"><i class="icon icon-youtube notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.pinterest.com/yegor256/" rel="nofollow" title="My Pinterest boards"><i class="icon icon-pinterest notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://angel.co/yegor256" rel="nofollow" title="My AngelList profile"><i class="icon icon-angellist notranslate" aria-hidden="true"></i></a></li> <li><a href="https://soundcloud.com/yegor256" rel="nofollow" title="My podcast"><i class="icon icon-podcast notranslate" aria-hidden="true"></i></a></li> <li><a href="https://itunes.apple.com/us/podcast/yegor256-podcast/id1150826721" rel="nofollow" title="My iTunes podcast"><i class="icon icon-itunes notranslate" aria-hidden="true"></i></a></li> <li><a href="https://t.me/yegor256news" rel="nofollow" title="My Telegram public channel"><i class="icon icon-telegram notranslate" aria-hidden="true"></i></a></li> <li><a href="mailto:blog@yegor256.com" rel="nofollow" title="Email me any time"><i class="icon icon-mail notranslate" aria-hidden="true"></i></a></li></ul><ul class="menu"> <li><a href="/" title="Home page">Home</a></li> <li ><a href="/best.html" title="Best articles to read">12&#160;Best</a></li> <li ><a href="/contents.html" title="The contents of the entire blog">All&#160;389</a></li> <li ><a href="/teaching.html" title="My courses and lectures">Teaching</a></li> <li ><a href="/talks.html" title="Future and past conference talks">Talks</a></li> <li ><a href="/books.html" title="The books I wrote">Books</a></li> <li ><a href="/research.html" title="My research directions and progress">Research</a></li> <li ><a href="/pets.html" title="My loved pet projects">Pets</a></li> <li ><a href="/testimonials.html" title="What some people say about me">Testimonials</a></li> <li ><a href="/shift-m.html" title="Audio podcast about project management">Shift-M</a></li> <li ><a href="/paintings.html" title="My paintings for sale">Art</a></li> <li><a href="https://ru.yegor256.com/" title="Немного на русском языке о политике в России, Украине и мире">Политика</a></li></ul></nav><div class="search"> <form method="get" action="https://www.google.com/search" itemprop="potentialAction" itemscope="" itemtype="http://schema.org/SearchAction"> <meta itemprop="target" content="https://www.google.com/search?q={q}"/> <input name="sitesearch" value="yegor256.com" type="hidden"/> <input itemprop="query-input" type="text" id="search-query" class="field field-text" required="required" onfocus="$('.google').css('visibility', 'visible');" name="q" placeholder="Search..." autocomplete="off"/> <input type="image" src="/images/google-search-icon.svg" class="google" title="Search via Google" alt="Search via Google"/> </form></div><div class="hot"><ul></ul></div></header></div><section itemscope="" itemtype="http://schema.org/BlogPosting"><div class="wrapper"> <header><h1 itemprop="name headline mainEntityOfPage">A Few Valid Reasons to Reject a Bug Fix</h1></header> <article class="main" itemprop="articleBody" style="font-family: sans-serif; font-size: 0.9em; line-height: 1.2em;"><p style="color: #C42C00;">The following text is a <em>partial</em> translation of the <a href='https://www.yegor256.com/2015/06/22/valid-reasons-to-reject-bug-fix.html'>original English article</a>, performed by <a href="https://chat.openai.com/">ChatGPT</a> (gpt-3.5-turbo) and <a href="https://github.com/yegor256/jekyll-chatgpt-translate">this Jekyll plugin</a>:</p><p>Баг существует, когда что-то не работает так, как ожидается. <em>Исправление бага</em> - это, по сути, патч (запрос на слияние), который предполагает решение проблемы и уверяет, что “что-то” работает так, как ожидается. Очень часто такой патч исправляет одну проблему и ломает много других. Я считаю, что иногда необходимо <em>отклонить</em> исправление бага и попросить автора повторно создать патч, чтобы защитить проект от более серьезных проблем. По моему опыту, есть несколько допустимых причин для такого отклонения.</p><h2 id="it-degrades-code-coverage">It Degrades Code Coverage</h2><p>Это очень распространенная ситуация: после внесения изменений в одном месте, модульные тесты начинают завершаться с ошибками в других местах. Ошибка исправлена, но некоторые возможно несвязанные модульные тесты начинают сообщать о неудаче. Под давлением или просто из-за лени, мы не исправляем их, а просто удаляем тесты или помечаем их временно как “пропущенные”. Проблема решена, сборка прошла успешно, поэтому давайте объединим патч и закончим на сегодня, верно? Неверно!</p><p>Хотя я за то, чтобы срезать углы насколько это возможно, это угол, который я не рекомендую вам урезать.</p><p>Модульные тесты существуют именно для того, чтобы предотвратить поломку продукта в условиях давления.</p><p>Очевидно, есть ситуации, когда модульные тесты неверные и их нужно удалить. В таких случаях не забудьте создать новые.</p><p>Также бывают ситуации, когда исправление ошибки должно быть выполнено за несколько минут, чтобы система снова заработала, а исправление всех модульных тестов займет час. Такая ситуация является явным признаком плохого положения дел с покрытием тестами в продукте. Несомненно, мы должны внести исправление и попросить наши тесты промолчать на некоторое время. Но в этом случае убедитесь, что следующей задачей, над которой будет работать ваша команда после исправления ошибки, будет исправление отключенных модульных тестов. Я рекомендую прочитать <a href="http://amzn.to/1SdcZ8M">Working Effectively With Legacy Code</a> Майкла Физерса, где подробно рассматривается этот вопрос.</p><h2 id="it-doesnt-reproduce-the-issue">It Doesn’t Reproduce the Issue</h2><p>Иногда вся система может быть недоступна просто из-за небольшой опечатки в одной строке кода. Очевидный способ исправить ошибку - удалить опечатку, но это не то, что ожидает от нас хороший проект, если мы заботимся о его качестве. Проблема не в опечатке, а в отсутствии модульных тестов, которые бы обнаружили опечатку на этапе развертывания.</p><p>Реальная проблема заключается в недостаточном охвате тестируемого кода в этой конкретной части кода. Удаление опечатки не помогает проекту никаким образом. Более того, мы делаем ему плохую услугу - мы <em>скрываем</em> настоящую проблему.</p><p>Таким образом, каким бы маленьким или незначительным ни был этот проблемный момент, его исправление должно содержать дополнительный тест, который сначала воспроизводит ошибку. Без такого теста исправление ошибки является пустой тратой денег проекта.</p><p>Более того, без модульного теста, воспроизводящего проблему, нет гарантии, что наша поправка ошибки не вносит новые ошибки. Я бы даже сказал, что чем больше исправлений ошибок у нас есть, тем выше <a href="http://ru.wikipedia.org/wiki/Энтропия_%28теория_информации%29">энтропия</a>. И единственный способ уменьшить эту неопределенность - покрыть код модульными тестами. Без теста исправление ошибки приносит больше беспорядка в кодовую базу.</p><h2 id="it-is-too-big">It Is Too Big</h2><p>Исправление ошибок - это <em>не функциональные возможности</em>; они должны быть маленькими и сфокусированными. Это очень типичная ошибка программистов - увлечься исправлением ошибки и внести некоторое рефакторинг вместе с исправлением. В результате патч становится достаточно большим и сложным для понимания. Я не против рефакторинга; это очень важная и положительная вещь для проекта, но делайте это отдельно <em>после</em> исправления ошибки и объединения.</p><p>Нет рефакторинга при исправлении ошибки!</p><p>Создайте новый модульный тест, воспроизведите ошибку и зафиксируйте ее. Исправьте ошибку в существующем кодовой базе, несмотря на его некрасивость. Создайте новые ошибки, попросив команду улучшить ситуацию с некрасивым кодом. Если интересно, назначьте себе эти ошибки. Или, возможно, кто-то другой заинтересуется исправлением и рефакторингом кода. Но все это произойдет позже в других запросах на слияние с новыми обзорами кода и новыми объединениями.</p><p>Это не о том, чтобы быть ленивым и не желать исправлять то, что выглядит плохо. Это о дисциплине, которая намного важнее хороших намерений.</p><h2 id="it-solves-more-than-one-issue">It Solves More Than One Issue</h2><p>Всегда исправляйте одну проблему за раз - так просто. Без исключений. Когда патч исправления ошибки содержит изменения кода, которые исправляют несколько проблем, очень сложно понять, какая проблема проверяется, какая воспроизводится и как они связаны друг с другом. Сочетание нескольких исправлений ошибок в один запрос на взятие изменений - очень плохая практика.</p><p>Независимо от того, насколько просто исправление, держите его отдельно от других. Проверьте, протестируйте и объедините его индивидуально. Это также увеличит прослеживаемость изменений. Всегда будет легко понять, кто сделал это исправление, кто проверил код и когда он был объединен (и развернут).</p><p class="jekyll-chatgpt-translate">Translated by ChatGPT gpt-3.5-turbo/36 on 2023-09-30 at 05:27</p></article></div><div class="wrapper"> <footer class="footer"><p> &copy; <span itemscope="" itemprop="copyrightHolder" itemtype="http://schema.org/Person"> <span itemprop="name">Yegor Bugayenko</span> </span> 2014&ndash;<span itemprop="copyrightYear">2023</span></p></footer></div></section><div class="wrapper unprintable" style="text-align:center;margin-top:2em;"> <a href="https://www.sixnines.io/h/3ba1652f"> <img src="//www.sixnines.io/b/3ba1652f?style=flat" alt="sixnines availability badge" /></a> &nbsp; <a href="https://github.com/yegor256/blog/stargazers"> <img src="//img.shields.io/github/stars/yegor256/blog.svg?style=flat-square" alt="GitHub stars" /></a></div><script src="//code.jquery.com/jquery-1.9.0.min.js"></script> <script src="/js/all.js?18ddfcd095e"></script> <script>var disqus_shortname = 'yegor256';</script> <script id="dsq-count-scr" src="//yegor256.disqus.com/count.js" async="async"></script> <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','//www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-1963507-32', 'auto'); ga('send', 'pageview'); </script> <script> Cd=document;Cr="&"+Math.random();Cp="&s=1"; Cd.cookie="b=b";if(Cd.cookie)Cp+="&c=1"; Cp+="&t="+(new Date()).getTimezoneOffset(); if(self!=top)Cp+="&f=1"; </script> <script> if(navigator.javaEnabled())Cp+="&j=1"; </script> <script> if(typeof(screen)!='undefined')Cp+="&w="+screen.width+"&h="+ screen.height+"&d="+(screen.colorDepth?screen.colorDepth:screen.pixelDepth); </script> <script> Cd.write("<img src='//c.hit.ua/hit?i=95870&g=0&x=2"+Cp+Cr+ "&r="+escape(Cd.referrer)+"&u="+escape(window.location.href)+ "' border='0' wi"+"dth='1' he"+"ight='1'/>"); </script> <script type="application/ld+json"> { "@context": "http://schema.org", "@type": "Person", "name": "Yegor Bugayenko", "url": "https://www.yegor256.com", "sameAs": [ "https://www.facebook.com/yegor256", "https://instagram.com/yegor256", "https://www.linkedin.com/in/yegor256", "https://twitter.com/yegor256", "https://github.com/yegor256", "https://www.pinterest.com/yegor256/" ] } </script> </body> </html>
